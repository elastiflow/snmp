- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "CLARENT-MIB"
- switch:
    - check: this.trap.SpecificTrap == 9901
      processors:
        - label: gateway_is_down
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Status"
            root.out.object.name = ""
            root.out.event.message = "Gateway Down"
    - check: this.trap.SpecificTrap == 9902
      processors:
        - label: restart_gwsuccess
          mapping: |
            #!blobl
            root = this

            root.out.event.message = "Gateway Restart Successful"
            root.out.event.category.name = "Gateway Status"
            root.out.object.name = ""
    - check: this.trap.SpecificTrap == 9903
      processors:
        - label: restart_gwfailed
          mapping: |
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "Gateway Restart Failed"
            root.out.event.category.name = "Gateway Status"
    - check: this.trap.SpecificTrap == 9904
      processors:
        - label: cc_is_down
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center Status"
            root.out.object.name = ""
            root.out.event.message = "Command Center Down"
    - check: this.trap.SpecificTrap == 9905
      processors:
        - label: restart_ccsuccess
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center Status"
            root.out.object.name = ""
            root.out.event.message = "Command Center Restart Successful"
    - check: this.trap.SpecificTrap == 9906
      processors:
        - label: restart_ccfailed
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center Status"
            root.out.object.name = ""
            root.out.event.message = "Command Center Restart Failed"
    - check: this.trap.SpecificTrap == 9907
      processors:
        - label: lost_cc
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Connection Status"
            root.out.object.name = "gwEntry."
            root.out.event.message = "Gateway Lost Connecton to Command Center  ( Gateway: " + this.trap.VarBinds.index(0).Value + " )"

            root.out.clarent.serverIpAddr = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9908
      processors:
        - label: connect_ccfailed
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Connection Status"
            root.out.object.name = "gwEntry."
            root.out.event.message = "Gateway Cannot Connect to Command Center  ( Gateway: " + this.trap.VarBinds.index(0).Value + " )"

            root.out.clarent.serverIpAddr = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9911
      processors:
        - label: port_out_of_service
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "Gateway Port Out of Service  ( " + "gwPortEntry." + this.trap.VarBinds.index(0).Value + " )"
            root.out.event.category.name = "Gateway Port Status"
            root.out.object.name = "gwPortEntry." + this.trap.VarBinds.index(0).Value

            root.out.clarent.portIndex = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9912
      processors:
        - label: port_in_service
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Port Status"
            root.out.object.name = "gwPortEntry." + this.trap.VarBinds.index(0).Value
            root.out.event.message = "Gateway Port In Service  ( " + "gwPortEntry." + this.trap.VarBinds.index(0).Value + " )"

            root.out.clarent.portIndex = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9913
      processors:
        - label: dial_up_no_voice_port
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Voice Port Status"
            root.out.object.name = ""
            root.out.event.message = "Gateway Cannot Dial Up, No Voice Port"
    - check: this.trap.SpecificTrap == 9914
      processors:
        - label: connect_no_voice_port
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Voice Port Status"
            root.out.object.name = ""
            root.out.event.message = "Gateway Cannot Connect to Other Gateway, No Voice Port"
    - check: this.trap.SpecificTrap == 9915
      processors:
        - label: gateway_connect
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "Gateway Connected to Command Center  ( Gateway: " + this.trap.VarBinds.index(0).Value + " )"
            root.out.event.category.name = "Connection Status"
            root.out.object.name = "gwEntry."

            root.out.clarent.serverIpAddr = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9916
      processors:
        - label: gateway_disconnect
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Connection Status"
            root.out.object.name = "gwEntry."
            root.out.event.message = "Gateway Disconnected from Command Center  ( Gateway: " + this.trap.VarBinds.index(0).Value + " )"

            root.out.clarent.serverIpAddr = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9917
      processors:
        - label: gw_not_registered
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Registration"
            root.out.object.name = "gwEntry." + this.trap.VarBinds.index(0).Value
            root.out.event.message = "Gateway Not Registered  ( " + "gwEntry." + this.trap.VarBinds.index(0).Value + " )"

            root.out.clarent.gwId = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9918
      processors:
        - label: call_rating_failed
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Call Rating Status"
            root.out.object.name = ""
            root.out.event.message = "Call Rating Failed, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9919
      processors:
        - label: invalid_cclicense
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center License Status"
            root.out.object.name = ""
            root.out.event.message = "Invalid Command Center License"
    - check: this.trap.SpecificTrap == 9920
      processors:
        - label: valid_cctmp_license
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center License Status"
            root.out.object.name = ""
            root.out.event.message = "Valid Temporary Command Center License"
    - check: this.trap.SpecificTrap == 9921
      processors:
        - label: ss7link_up
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "SS7 Link Status"
            root.out.object.name = ""
            root.out.event.message = "SS7 Link Up"
    - check: this.trap.SpecificTrap == 9922
      processors:
        - label: ss7link_down
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "SS7 Link Status"
            root.out.object.name = ""
            root.out.event.message = "SS7 Link Down"
    - check: this.trap.SpecificTrap == 9927
      processors:
        - label: gw_app_shutdown
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "Gateway Shutdown, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
            root.out.event.category.name = "Gateway Status"

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9928
      processors:
        - label: resetting_dspbrd
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "DSP Board Status"
            root.out.object.name = ""
            root.out.event.message = "DSP Board Resetting, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9929
      processors:
        - label: clr_hse_credit_schg
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Clearing House Credit Status"
            root.out.object.name = ""
            root.out.event.message = "Clearing House Credit Status Changed, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9930
      processors:
        - label: cc_credit_schg
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Clarent Connect Credit Status"
            root.out.object.name = ""
            root.out.event.message = "Clarent Connect Credit Status Changed, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9931
      processors:
        - label: validate_egerr
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Gateway Validation"
            root.out.object.name = ""
            root.out.event.message = "Gateway Validate Egress Error, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9932
      processors:
        - label: lic_roll_back
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Command Center License Status"
            root.out.object.name = ""
            root.out.event.message = "Command Center License Key Change Rolled Back"
    - check: this.trap.SpecificTrap == 9933
      processors:
        - label: clarent_info
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2858.48.2") + " Error"
            root.out.object.name = ""
            root.out.event.message = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapSeverity = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2858.48.1")
            root.out.clarent.trapClass = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2858.48.2")
            root.out.clarent.trapNumber = this.trap.VarBinds.index(2).Value
            root.out.clarent.trapCount = this.trap.VarBinds.index(3).Value
            root.out.clarent.trapText = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()
        - label: clarent_info_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value == 0
              processors:
                - label: clarent_info_nested_switch_0
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 1
              processors:
                - label: clarent_info_nested_switch_1
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 2
              processors:
                - label: clarent_info_nested_switch_2
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 3
              processors:
                - label: clarent_info_nested_switch_3
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 4
              processors:
                - label: clarent_info_nested_switch_4
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: clarent_info_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: clarent_info_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 9934
      processors:
        - label: software_update
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "Software " + this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2858.100.1.99999") + " Operation Error  ( " + "Package: " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string() + " )"
            root.out.event.category.name = "Software Update Status"
            root.out.object.name = "Package: " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.packageName = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
            root.out.clarent.packageOperation = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2858.100.1.99999")
            root.out.clarent.packageStatus = this.trap.VarBinds.index(2).Value.enum_enrich(".1.3.6.1.4.1.2858.100.1.2.1.2")
    - check: this.trap.SpecificTrap == 9935
      processors:
        - label: number_intercept
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Number Intercept"
            root.out.object.name = ""
            root.out.event.message = "Call Placed to Intercept Number, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9936
      processors:
        - label: tp_is_down
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "ThroughPacket Server Status"
            root.out.object.name = ""
            root.out.event.message = "ThroughPacket Server Down"
    - check: this.trap.SpecificTrap == 9937
      processors:
        - label: restart_tpfailed
          mapping: |
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "ThroughPacket Server Restart Failed"
            root.out.event.category.name = "ThroughPacket Server Status"
    - check: this.trap.SpecificTrap == 9938
      processors:
        - label: tp_restarted
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "ThroughPacket Server Status"
            root.out.object.name = ""
            root.out.event.message = "ThroughPacket Server Restart Successful"
    - check: this.trap.SpecificTrap == 9939
      processors:
        - label: thresh_hold_trap
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Application Threshold ( " + this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string() + " )"
            root.out.object.name = "Application: " + this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.event.message = ""

            root.out.clarent.trapSeverity = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2858.48.1")
            root.out.clarent.trapAppName = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.clarent.threshHoldName = this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string()
            root.out.clarent.threshHoldValue = this.trap.VarBinds.index(3).Value
            root.out.clarent.currentValue = this.trap.VarBinds.index(4).Value
            root.out.clarent.threshHoldAction = this.trap.VarBinds.index(5).Value.enum_enrich(".1.3.6.1.4.1.2858.48.10")
        - label: thresh_hold_trap_nested_switch
          switch:
            - check: this.trap.VarBinds.index(5).Value == 0
              processors:
                - label: thresh_hold_trap_nested_switch_0
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(5).Value == 1
              processors:
                - label: thresh_hold_trap_nested_switch_1
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(5).Value == 2
              processors:
                - label: thresh_hold_trap_nested_switch_2
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(5).Value == 3
              processors:
                - label: thresh_hold_trap_nested_switch_3
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(5).Value == 4
              processors:
                - label: thresh_hold_trap_nested_switch_4
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: thresh_hold_trap_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: thresh_hold_trap_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.event.message = "Threshold " + this.trap.VarBinds.index(5).Value.enum_enrich(".1.3.6.1.4.1.2858.48.10") + ": " + this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string() + ", " + this.trap.VarBinds.index(4).Value + ", Crossed " + this.trap.VarBinds.index(3).Value + "  ( " + root.out.object.name + " )"
    - check: this.trap.SpecificTrap == 9940
      processors:
        - label: system_reboot
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "System Reboot"
            root.out.object.name = ""
            root.out.event.message = "System Rebooting, startShutdown Command, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9941
      processors:
        - label: reboot_command
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "System Reboot"
            root.out.object.name = ""
            root.out.event.message = "System Enabled to Receive startShutdown Command, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9942
      processors:
        - label: c_disk_space_low
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Disk Space Status"
            root.out.object.name = ""
            root.out.event.message = "Disk Space Low, < 50MB, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9943
      processors:
        - label: c_no_connect_route
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "Connect Partner Does Not Have a Call Route, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
            root.out.event.category.name = "Connect Route Status"
            root.out.object.name = ""

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9944
      processors:
        - label: db_error
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "Database Error, " + this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string()
            root.out.event.category.name = "Database Status"
            root.out.object.name = ""

            root.out.clarent.trapSeverity = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2858.48.1")
            root.out.clarent.trapNumber = this.trap.VarBinds.index(1).Value
            root.out.clarent.trapText = this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string()
            root.out.clarent.trapCount = this.trap.VarBinds.index(3).Value
        - label: db_error_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value == 0
              processors:
                - label: db_error_nested_switch_0
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 1
              processors:
                - label: db_error_nested_switch_1
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 2
              processors:
                - label: db_error_nested_switch_2
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 3
              processors:
                - label: db_error_nested_switch_3
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(0).Value == 4
              processors:
                - label: db_error_nested_switch_4
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: db_error_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: db_error_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 9945
      processors:
        - label: db_clerk_started
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Database Clerk Status"
            root.out.object.name = ""
            root.out.event.message = "New Database Clerk Started, " + this.trap.VarBinds.index(0).Value + " Clerks Running" + ", " + this.trap.VarBinds.index(0).Value

            root.out.clarent.trapNumber = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9946
      processors:
        - label: restart_dmfailed
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Distribution Service Status"
            root.out.object.name = ""
            root.out.event.message = "Distribution Service Restart Failed"
    - check: this.trap.SpecificTrap == 9947
      processors:
        - label: dm_restarted
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Distribution Service Status"
            root.out.object.name = ""
            root.out.event.message = "Distribution Service Restart Successful"
    - check: this.trap.SpecificTrap == 9948
      processors:
        - label: dm_is_down
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Distribution Service Status"
            root.out.object.name = ""
            root.out.event.message = "Distribution Service Down"
    - check: this.trap.SpecificTrap == 9949
      processors:
        - label: sig_gwmtppause
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "Message Transfer Protocol Paused, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
            root.out.event.category.name = "Message Transfer Protocol Status"

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9950
      processors:
        - label: sig_gwmtpresume
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Message Transfer Protocol Status"
            root.out.object.name = ""
            root.out.event.message = "Message Transfer Protocol Resumed, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9951
      processors:
        - label: sig_gwtask_active
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Signaling Task Status"
            root.out.object.name = ""
            root.out.event.message = "Signaling Task Started, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 9952
      processors:
        - label: pin_suspended
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Account Status"
            root.out.object.name = ""
            root.out.event.message = "Account Suspended, " + this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()

            root.out.clarent.trapText = this.trap.VarBinds.index(0).Value.snmp_v2_tc_display_string()
    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
