- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "SN-OSM-PRIV-MIB"
- switch:
    - check: this.trap.SpecificTrap == 11
      processors:
        - label: sn_osm_rm_active_state
          mapping: |
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "Redundancy Manager Active"
            root.out.event.category.name = "Redundancy Manager Status"
    - check: this.trap.SpecificTrap == 12
      processors:
        - label: sn_osm_rm_passive_state
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Redundancy Manager Status"
            root.out.object.name = ""
            root.out.event.message = "Redundancy Manager Passive"
    - check: this.trap.SpecificTrap == 21
      processors:
        - label: sn_osm_standby_active_state
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Device Standby Status"
            root.out.object.name = ""
            root.out.event.message = "Device Standby Active"
    - check: this.trap.SpecificTrap == 22
      processors:
        - label: sn_osm_standby_passive_state
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Device Standby Status"
            root.out.object.name = ""
            root.out.event.message = "Device Standby Passive"
    - check: this.trap.SpecificTrap == 31
      processors:
        - label: sn_osm_power_line_down
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Power Line Status"

            root.out.siemens_ad.snOsmChangedPowerLine = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.4196.1.1.2.100.2.1.45")
        - label: sn_osm_power_line_down_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value == 0
              processors:
                - label: sn_osm_power_line_down_nested_switch_0
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line Unknown"
            - check: this.trap.VarBinds.index(0).Value == 1
              processors:
                - label: sn_osm_power_line_down_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line 1"
            - check: this.trap.VarBinds.index(0).Value == 2
              processors:
                - label: sn_osm_power_line_down_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line 2"
            - processors:
                - label: sn_osm_power_line_down_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line Unknown"
        - label: sn_osm_power_line_down_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.event.message = "Power Down  ( " + root.out.object.name + " )"
    - check: this.trap.SpecificTrap == 32
      processors:
        - label: sn_osm_power_line_up
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Power Line Status"

            root.out.siemens_ad.snOsmChangedPowerLine = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.4196.1.1.2.100.2.1.45")
        - label: sn_osm_power_line_up_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value == 0
              processors:
                - label: sn_osm_power_line_up_nested_switch_0
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line Unknown"
            - check: this.trap.VarBinds.index(0).Value == 1
              processors:
                - label: sn_osm_power_line_up_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line 1"
            - check: this.trap.VarBinds.index(0).Value == 2
              processors:
                - label: sn_osm_power_line_up_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line 2"
            - processors:
                - label: sn_osm_power_line_up_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.object.name = "Line Unknown"
        - label: sn_osm_power_line_up_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.event.message = "Power Up  ( " + root.out.object.name + " )"
    - check: this.trap.SpecificTrap == 41
      processors:
        - label: sn_osm_fault
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Device Status"
            root.out.object.name = ""

            root.out.siemens_ad.snOsmFaultValue = this.trap.VarBinds.index(0).Value
        - label: sn_osm_fault_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value.string() == 0
              processors:
                - label: sn_osm_fault_nested_switch_0
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Device Faults Cleared"
            - processors:
                - label: sn_osm_fault_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Device Fault List: Unknown Fault"
        - label: sn_osm_fault_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 51
      processors:
        - label: sn_osm_digital_input
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Digital Input Status"
            root.out.object.name = ""
            root.out.event.message = "Digital Input State: " + this.trap.VarBinds.index(1).Value.string() + ", Digital Input Value: " + this.trap.VarBinds.index(0).Value.string()

            root.out.siemens_ad.snOsmDigitalInputChange = this.trap.VarBinds.index(0).Value
            root.out.siemens_ad.snOsmDigitalInputState = this.trap.VarBinds.index(1).Value
        - label: sn_osm_digital_input_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value.string() == 0
              processors:
                - label: sn_osm_digital_input_nested_switch_0
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: sn_osm_digital_input_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: sn_osm_digital_input_after_switch
          mapping: |+
            #!blobl
            root = this

    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
