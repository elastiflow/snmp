- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "VTCOMMON-MIB"
- switch:
    - check: this.trap.SpecificTrap == 1
      processors:
        - label: server_in_service
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server In Service  ( Server:  )"

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
    - check: this.trap.SpecificTrap == 2
      processors:
        - label: server_out_of_service
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server Out of Service  ( Server:  )"

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
    - check: this.trap.SpecificTrap == 3
      processors:
        - label: server_shutting_down
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server Shutting Down  ( Server:  )"

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
    - check: this.trap.SpecificTrap == 4
      processors:
        - label: server_maintenance
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server in Maintenance  ( Server:  )"

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
    - check: this.trap.SpecificTrap == 5
      processors:
        - label: server_configuration_fault
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server Configuration Fault  ( Server:  )"

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
    - check: this.trap.SpecificTrap == 6
      processors:
        - label: server_in_transition
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "Server Status"
            root.out.object.name = "opModeEntry." + this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + "."
            root.out.event.message = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1") + " Server in Transition, Currently " + this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.4")

            root.out.vocaltec.vtServerType = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.1")
            root.out.vocaltec.vtCurrentOpMode = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.4.1.2516.1.1.1.4")
        - label: server_in_transition_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value == 13
              processors:
                - label: server_in_transition_nested_switch_13
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 14
              processors:
                - label: server_in_transition_nested_switch_14
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 15
              processors:
                - label: server_in_transition_nested_switch_15
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 16
              processors:
                - label: server_in_transition_nested_switch_16
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 17
              processors:
                - label: server_in_transition_nested_switch_17
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 18
              processors:
                - label: server_in_transition_nested_switch_18
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 19
              processors:
                - label: server_in_transition_nested_switch_19
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 20
              processors:
                - label: server_in_transition_nested_switch_20
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 21
              processors:
                - label: server_in_transition_nested_switch_21
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 22
              processors:
                - label: server_in_transition_nested_switch_22
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 23
              processors:
                - label: server_in_transition_nested_switch_23
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: server_in_transition_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: server_in_transition_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.event.message = root.out.event.message + "  ( Server: $ServerIpAddr )"
    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
