- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "CISCO-ISDN-MIB"
- switch:
    - check: this.trap.SpecificTrap == 1
      processors:
        - label: demand_nbr_call_information
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCallInformation"
            root.out.event.id = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCallInformation"
            root.out.event.category.name = "ISDN Call Status"
            root.out.object.name = "demandNbrEntry.9.26"

            root.out.cisco.demandNbrLogIf = this.trap.VarBinds.index(0).Value
            root.out.cisco.demandNbrName = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrAddress = this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrLastDuration = this.trap.VarBinds.index(3).Value
            root.out.cisco.demandNbrClearReason = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrClearCode = this.trap.VarBinds.index(5).Value
        - label: demand_nbr_call_information_nested_switch
          switch:
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Call is Active
              processors:
                - label: demand_nbr_call_information_nested_switch_call is active
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Active"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Call rejected
              processors:
                - label: demand_nbr_call_information_nested_switch_call rejected
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Rejected"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Destination out of order
              processors:
                - label: demand_nbr_call_information_nested_switch_destination out of order
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Destination Out of Order"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Interworking error; unspecified
              processors:
                - label: demand_nbr_call_information_nested_switch_interworking error; unspecified
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Interworking Error"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Invalid call reference value
              processors:
                - label: demand_nbr_call_information_nested_switch_invalid call reference value
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Invalid Call Reference Value"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == No user responding
              processors:
                - label: demand_nbr_call_information_nested_switch_no user responding
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call No User Responding"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Normal call clearing
              processors:
                - label: demand_nbr_call_information_nested_switch_normal call clearing
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Normal Clearing"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Normal, unspecified
              processors:
                - label: demand_nbr_call_information_nested_switch_normal, unspecified
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Normal, Unspecified"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Recovery on timer expiry
              processors:
                - label: demand_nbr_call_information_nested_switch_recovery on timer expiry
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Recovered on Timer Expiry"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Requested circuit/channel not available
              processors:
                - label: demand_nbr_call_information_nested_switch_requested circuit/channel not available
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Requested Circuit/Channel Not Available"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Temporary failure
              processors:
                - label: demand_nbr_call_information_nested_switch_temporary failure
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Temporary Failure"
            - check: this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string() == Unknown Cause value
              processors:
                - label: demand_nbr_call_information_nested_switch_unknown cause value
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call Cleared, Unknown Cause"
            - processors:
                - label: demand_nbr_call_information_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call, " + this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string().string()
        - label: demand_nbr_call_information_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.event.message = root.out.event.message + ", Clear Code: " + this.trap.VarBinds.index(5).Value.string() + "  ( Call Address: " + this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string().string() + " )"
    - check: this.trap.SpecificTrap == 2
      processors:
        - label: demand_nbr_call_details
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "demandNbrEntry.9.26"
            root.out.event.class.name = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCallDetails"
            root.out.event.id = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCallDetails"
            root.out.event.category.name = "ISDN Call Status"

            root.out.cisco.demandNbrLogIf = this.trap.VarBinds.index(0).Value
            root.out.cisco.demandNbrName = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrAddress = this.trap.VarBinds.index(2).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrLastDuration = this.trap.VarBinds.index(3).Value
            root.out.cisco.demandNbrClearReason = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()
            root.out.cisco.demandNbrClearCode = this.trap.VarBinds.index(5).Value
            root.out.cisco.demandNbrCallOrigin = this.trap.VarBinds.index(6).Value.enum_enrich(".1.3.6.1.4.1.9.9.26.1.1.1.1.17")
        - label: demand_nbr_call_details_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == 1
              processors:
                - label: demand_nbr_call_details_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Outgoing Call"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == 2
              processors:
                - label: demand_nbr_call_details_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Incoming Call"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == 3
              processors:
                - label: demand_nbr_call_details_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Callback"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Call is Active
              processors:
                - label: demand_nbr_call_details_nested_switch_call is active
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Active"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Call rejected
              processors:
                - label: demand_nbr_call_details_nested_switch_call rejected
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Rejected"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Destination out of order
              processors:
                - label: demand_nbr_call_details_nested_switch_destination out of order
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Destination Out of Order"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Interworking error; unspecified
              processors:
                - label: demand_nbr_call_details_nested_switch_interworking error; unspecified
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Interworking Error"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Invalid call reference value
              processors:
                - label: demand_nbr_call_details_nested_switch_invalid call reference value
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Invalid Call Reference Value"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == No user responding
              processors:
                - label: demand_nbr_call_details_nested_switch_no user responding
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " No User Responding"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Normal call clearing
              processors:
                - label: demand_nbr_call_details_nested_switch_normal call clearing
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Normal Clearing"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Normal, unspecified
              processors:
                - label: demand_nbr_call_details_nested_switch_normal, unspecified
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Normal, Unspecified"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Recovery on timer expiry
              processors:
                - label: demand_nbr_call_details_nested_switch_recovery on timer expiry
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Recovered on Timer Expiry"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Requested circuit/channel not available
              processors:
                - label: demand_nbr_call_details_nested_switch_requested circuit/channel not available
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Requested Circuit/Channel Not Available"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Temporary failure
              processors:
                - label: demand_nbr_call_details_nested_switch_temporary failure
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Temporary Failure"
            - check: this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string().string() == Unknown Cause value
              processors:
                - label: demand_nbr_call_details_nested_switch_unknown cause value
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = root.out.event.message + " Cleared, Unknown Cause"
            - processors:
                - label: demand_nbr_call_details_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN Call  ( " + root.out.object.name + " )"
        - label: demand_nbr_call_details_after_switch
          mapping: |
            #!blobl
            root = this

            root.out.object.name = "demandNbrEntry.9.26"
    - check: this.trap.SpecificTrap == 3
      processors:
        - label: demand_nbr_layer2change
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrLayer2Change"
            root.out.event.id = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrLayer2Change"
            root.out.event.category.name = "ISDN D-Channel Status"
            root.out.object.name = "isdnLapdEntry." + this.trap.VarBinds.index(0).Value.string()

            root.out.cisco.ifIndex = this.trap.VarBinds.index(0).Value
            root.out.cisco.isdnLapdOperStatus = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.2.1.10.20.1.3.4.1.2")
        - label: demand_nbr_layer2change_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value == 1
              processors:
                - label: demand_nbr_layer2change_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN D-Channel All Layers Inactive"
            - check: this.trap.VarBinds.index(1).Value == 2
              processors:
                - label: demand_nbr_layer2change_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN D-Channel Layer-1 Activated, Layer-2 Datalink Not Established"
            - check: this.trap.VarBinds.index(1).Value == 3
              processors:
                - label: demand_nbr_layer2change_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "ISDN D-Channel Layer-1 Activated, Layer-2 Datalink Established"
            - processors:
                - label: demand_nbr_layer2change_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: demand_nbr_layer2change_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 4
      processors:
        - label: demand_nbr_cnanotification
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCNANotification"
            root.out.event.id = "SNMPTRAP-cisco-CISCO-ISDN-MIB-demandNbrCNANotification"
            root.out.event.category.name = "ISDN Incoming Call Status"
            root.out.object.name = "ifEntry." + this.trap.VarBinds.index(1).Value.string()
            root.out.event.message = "ISDN Incoming Call Rejected, Requested Circuit/Channel Not Available  ( " + "ifEntry." + this.trap.VarBinds.index(1).Value.string() + " )"

            root.out.cisco.isdnSignalingIfIndex = this.trap.VarBinds.index(0).Value
            root.out.cisco.ifIndex = this.trap.VarBinds.index(1).Value
    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
