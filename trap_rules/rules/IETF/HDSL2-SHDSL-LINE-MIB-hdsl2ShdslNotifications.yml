- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "HDSL2-SHDSL-LINE-MIB"
- switch:
    - check: this.trap.SpecificTrap == 1
      processors:
        - label: hdsl2shdsl_loop_atten_crossing
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLoopAttenCrossing"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLoopAttenCrossing"
            root.out.event.category.name = "HDSL2/SHDSL Loop Attenuation Threshold"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.lookup("10", Hdsl2ShdslUnitSide)_Raw.48"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint Loop Attenuation, " + this.trap.VarBinds.index(0).Value.string() + "dB, Exceeded " + this.trap.VarBinds.index(1).Value.string() + "dB  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"

            root.out.IETF.hdsl2ShdslEndpointCurrAtn = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshLoopAttenuation = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 2
      processors:
        - label: hdsl2shdsl_snrmargin_crossing
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslSNRMarginCrossing"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslSNRMarginCrossing"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.10.48"
            root.out.event.category.name = "HDSL2/SHDSL SNR Margin Threshold"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint SNR Margin, " + this.trap.VarBinds.index(0).Value.string() + "dB, Exceeded " + this.trap.VarBinds.index(1).Value.string() + "dB  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"

            root.out.IETF.hdsl2ShdslEndpointCurrSnrMgn = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshSNRMargin = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 3
      processors:
        - label: hdsl2shdsl_perf_esthresh
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.10.48"
            root.out.event.category.name = "HDSL2/SHDSL ES 15 Min. Threshold"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfESThresh"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfESThresh"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint Errored Seconds, " + this.trap.VarBinds.index(0).Value.string() + " secs., Exceeded " + this.trap.VarBinds.index(1).Value.string() + " secs.  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"

            root.out.IETF.hdsl2ShdslEndpointCurr15MinES = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshES = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 4
      processors:
        - label: hdsl2shdsl_perf_sesthresh
          mapping: |-
            #!blobl
            root = this

            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.category.name = "HDSL2/SHDSL SES 15 Min. Threshold"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.lookup("1", Hdsl2ShdslUnitId)_Raw.10.48"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfSESThresh"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfSESThresh"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint Severely Errored Seconds, " + this.trap.VarBinds.index(0).Value.string() + " secs., Exceeded " + this.trap.VarBinds.index(1).Value.string() + " secs.  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"

            root.out.IETF.hdsl2ShdslEndpointCurr15MinSES = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshSES = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 5
      processors:
        - label: hdsl2shdsl_perf_crcanomalies_thresh
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "HDSL2/SHDSL CRC 15 Min. Threshold"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfCRCanomaliesThresh"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfCRCanomaliesThresh"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.lookup("10", Hdsl2ShdslUnitSide)_Raw.48"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint CRC Anomalies, " + this.trap.VarBinds.index(0).Value.string() + ", Exceeded " + this.trap.VarBinds.index(1).Value.string() + "  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"

            root.out.IETF.hdsl2ShdslEndpointCurr15MinCRCanomalies = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshCRCanomalies = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 6
      processors:
        - label: hdsl2shdsl_perf_loswsthresh
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "HDSL2/SHDSL Segment Endpoint Loss of Sync Word Seconds, " + this.trap.VarBinds.index(0).Value.string() + " secs., Exceeded " + this.trap.VarBinds.index(1).Value.string() + " secs.  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfLOSWSThresh"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfLOSWSThresh"
            root.out.event.category.name = "HDSL2/SHDSL LOSW Secs. 15 Min. Threshold"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.lookup("1", Hdsl2ShdslUnitId)_Raw.10.48"

            root.out.IETF.hdsl2ShdslEndpointCurr15MinLOSWS = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshLOSWS = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 7
      processors:
        - label: hdsl2shdsl_perf_uasthresh
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "HDSL2/SHDSL Unavailable Secs. 15 Min. Threshold"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.lookup("1", Hdsl2ShdslUnitId)_Raw.10.48"
            root.out.event.message = "HDSL2/SHDSL Segment Endpoint Unavailable Seconds, " + this.trap.VarBinds.index(0).Value.string() + " secs., Exceeded " + this.trap.VarBinds.index(1).Value.string() + " secs.  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfUASThresh"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslPerfUASThresh"

            root.out.IETF.hdsl2ShdslEndpointCurr15MinUAS = this.trap.VarBinds.index(0).Value
            root.out.IETF.hdsl2ShdslEndpointThreshUAS = this.trap.VarBinds.index(1).Value
    - check: this.trap.SpecificTrap == 8
      processors:
        - label: hdsl2shdsl_span_invalid_num_repeaters
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "hdsl2ShdslSpanConfEntry.48"
            root.out.event.message = "HDSL2/SHDSL Configured Repeater/Regenerator Units Differs from EOC Discovery  ( hdsl2ShdslSpanConfEntry.48 )"
            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.category.name = "HDSL2/SHDSL Repeater/Regenerator Configuration Mismatch"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslSpanInvalidNumRepeaters"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslSpanInvalidNumRepeaters"

            root.out.IETF.hdsl2ShdslSpanConfNumRepeaters = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 9
      processors:
        - label: hdsl2shdsl_loopback_failure
          mapping: |-
            #!blobl
            root = this

            root.out.event.severity.code = 3
            root.out.event.severity.level = "Error"
            root.out.event.category.name = "HDSL2/SHDSL Loopback Status"
            root.out.object.name = "hdsl2ShdslEndpointMaintEntry.1.lookup("10", Hdsl2ShdslUnitId)_Raw.48"
            root.out.event.message = "HDSL2/SHDSL Loopback Failure  ( Interface: ifEntry.1, Unit ID: lookup("10", Hdsl2ShdslUnitId), Side: lookup("48", Hdsl2ShdslUnitSide) )"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLoopbackFailure"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLoopbackFailure"

            root.out.IETF.hdsl2ShdslMaintLoopbackConfig = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.8.1.1")
    - check: this.trap.SpecificTrap == 10
      processors:
        - label: hdsl2shdslpower_backoff
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "End of HDSL2/SHDSL Power Backoff  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.lookup("1", Hdsl2ShdslUnitId)_Raw.lookup("10", Hdsl2ShdslUnitSide)_Raw.48"
            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslpowerBackoff"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslpowerBackoff"
            root.out.event.category.name = "HDSL2/SHDSL Power Status"

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 11
      processors:
        - label: hdsl2shdsldevice_fault
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "End of HDSL2/SHDSL Device Fault  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.lookup("1", Hdsl2ShdslUnitId)_Raw.10.48"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdsldeviceFault"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdsldeviceFault"
            root.out.event.category.name = "HDSL2/SHDSL Device Status"

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 12
      processors:
        - label: hdsl2shdsldc_continuity_fault
          mapping: |-
            #!blobl
            root = this

            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdsldcContinuityFault"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdsldcContinuityFault"
            root.out.event.category.name = "HDSL2/SHDSL DC Continuity Status"
            root.out.event.message = "End of HDSL2/SHDSL DC Continuity Fault  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.10.lookup("48", Hdsl2ShdslWirePair)_Raw

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 13
      processors:
        - label: hdsl2shdslconfig_init_failure
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslconfigInitFailure"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslconfigInitFailure"
            root.out.event.category.name = "HDSL2/SHDSL Configuration Status"
            root.out.event.message = "End of HDSL2/SHDSL Endpoint Initialization Failed, Configuration Not Supported  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.lookup("10", Hdsl2ShdslUnitSide)_Raw.lookup("48", Hdsl2ShdslWirePair)_Raw

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 14
      processors:
        - label: hdsl2shdslprotocol_init_failure
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.lookup("10", Hdsl2ShdslUnitSide)_Raw.lookup("48", Hdsl2ShdslWirePair)_Raw
            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.event.message = "End of HDSL2/SHDSL Endpoint Initialization Failed, Protocol Incompatible  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslprotocolInitFailure"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslprotocolInitFailure"
            root.out.event.category.name = "HDSL2/SHDSL Protocol Status"

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 15
      processors:
        - label: hdsl2shdslno_neighbor_present
          mapping: |-
            #!blobl
            root = this

            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslnoNeighborPresent"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslnoNeighborPresent"
            root.out.event.message = "End of HDSL2/SHDSL Neighbor Not Present  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId), Side: lookup("10", Hdsl2ShdslUnitSide), Pair: lookup("48", Hdsl2ShdslWirePair) )"
            root.out.event.severity.code = 1
            root.out.event.severity.level = "Alert"
            root.out.object.name = "hdsl2ShdslEndpointCurrEntry.2.1.10.48"
            root.out.event.category.name = "HDSL2/SHDSL Neighbor Status"

            root.out.IETF.hdsl2ShdslEndpointCurrStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.10.48.1.5.1.3")
    - check: this.trap.SpecificTrap == 16
      processors:
        - label: hdsl2shdsl_local_power_loss
          mapping: |-
            #!blobl
            root = this

            root.out.event.severity.code = 4
            root.out.event.severity.level = "Warning"
            root.out.event.class.name = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLocalPowerLoss"
            root.out.event.id = "SNMPTRAP-IETF-HDSL2-SHDSL-LINE-MIB-hdsl2ShdslLocalPowerLoss"
            root.out.object.name = "hdsl2ShdslInventoryEntry.2.1"
            root.out.event.category.name = "HDSL2/SHDSL Local Power Status"
            root.out.event.message = "HDSL2/SHDSL Local Power Loss, Impending Unit Failure  ( Interface: ifEntry.2, Unit ID: lookup("1", Hdsl2ShdslUnitId) )"

            root.out.IETF.hdsl2ShdslInvVendorID = this.trap.VarBinds.index(0).Value
    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
