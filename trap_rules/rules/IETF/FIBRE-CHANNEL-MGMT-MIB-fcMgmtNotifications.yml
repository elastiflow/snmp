- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "FIBRE-CHANNEL-MGMT-MIB"
- switch:
    - check: this.trap.SpecificTrap == 1
      processors:
        - label: fc_conn_unit_status_change
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Conn. Unit Status"
            root.out.object.name = "fcConnUnitEntry."

            root.out.IETF.fcConnUnitStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.3.1.7")
            root.out.IETF.fcConnUnitState = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.3.1.6")
        - label: fc_conn_unit_status_change_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value == 2
              processors:
                - label: fc_conn_unit_status_change_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Status Unknown, Online  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 3
              processors:
                - label: fc_conn_unit_status_change_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Status Unknown, Offline  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 4
              processors:
                - label: fc_conn_unit_status_change_nested_switch_4
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 5
              processors:
                - label: fc_conn_unit_status_change_nested_switch_5
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: fc_conn_unit_status_change_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Status Unknown, State Unknown  ( " + root.out.object.name + " )"
        - label: fc_conn_unit_status_change_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 2
      processors:
        - label: fc_conn_unit_deleted_trap
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Conn. Unit"
            root.out.object.name = "fcConnUnitEntry."
            root.out.event.message = "Connectivity Unit Deleted  ( fcConnUnitEntry. )"

            root.out.IETF.fcConnUnitGlobalId = this.trap.VarBinds.index(0).Value
    - check: this.trap.SpecificTrap == 3
      processors:
        - label: fc_conn_unit_event_trap
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "fcConnUnitEventEntry." + this.trap.VarBinds.index(0).Value
            root.out.event.message = "Connectivity Unit " + this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.7.1.5") + " Event, " + this.trap.VarBinds.index(3).Value + "  ( " + this.trap.VarBinds.index(2).Value + " )"
            root.out.event.category.name = "Conn. Unit Event"

            root.out.IETF.fcConnUnitGlobalId = this.trap.VarBinds.index(0).Value
            root.out.IETF.fcConnUnitEventType = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.7.1.5")
            root.out.IETF.fcConnUnitEventObject = this.trap.VarBinds.index(2).Value
            root.out.IETF.fcConnUnitEventDescr = this.trap.VarBinds.index(3).Value
    - check: this.trap.SpecificTrap == 4
      processors:
        - label: fc_conn_unit_sensor_status_change
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = "fcConnUnitSensorEntry."
            root.out.event.category.name = "Conn. Unit Sensor Status"

            root.out.IETF.fcConnUnitSensorStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.5.1.3")
        - label: fc_conn_unit_sensor_status_change_nested_switch
          switch:
            - check: this.trap.VarBinds.index(0).Value == 1
              processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Sensor Status Unknown  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(0).Value == 2
              processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Sensor Status: Other  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(0).Value == 3
              processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Sensor OK  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(0).Value == 4
              processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_4
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Sensor Warning  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(0).Value == 5
              processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_5
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Sensor Failed  ( " + root.out.object.name + " )"
            - processors:
                - label: fc_conn_unit_sensor_status_change_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: fc_conn_unit_sensor_status_change_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 5
      processors:
        - label: fc_conn_unit_port_status_change
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Conn. Unit Port Status"
            root.out.object.name = "fcConnUnitPortEntry."

            root.out.IETF.fcConnUnitPortStatus = this.trap.VarBinds.index(0).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.6.1.6")
            root.out.IETF.fcConnUnitPortState = this.trap.VarBinds.index(1).Value.enum_enrich(".1.3.6.1.2.1.8888.1.1.6.1.5")
        - label: fc_conn_unit_port_status_change_nested_switch
          switch:
            - check: this.trap.VarBinds.index(1).Value == 10
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_10
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 2
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Port Status: Unknown, Online  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 3
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Port Status: Unknown, Offline  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 4
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_4
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Port Status: Unknown, Bypassed  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 5
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_5
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Port Status: Unknown, Diagnostics  ( " + root.out.object.name + " )"
            - check: this.trap.VarBinds.index(1).Value == 6
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_6
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 7
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_7
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 8
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_8
                  mapping: |+
                    #!blobl
                    root = this

            - check: this.trap.VarBinds.index(1).Value == 9
              processors:
                - label: fc_conn_unit_port_status_change_nested_switch_9
                  mapping: |+
                    #!blobl
                    root = this

            - processors:
                - label: fc_conn_unit_port_status_change_nested_switch_default
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Connectivity Unit Port Status: Unknown, Unknown  ( " + root.out.object.name + " )"
        - label: fc_conn_unit_port_status_change_after_switch
          mapping: |+
            #!blobl
            root = this

    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
