- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "EXTREME-TRAP-MIB"
- switch:
    - check: this.trap.SpecificTrap == 6
      processors:
        - label: extreme_overheat
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Temperature"
            root.out.object.name = ""
            root.out.event.message = "Tempature sensor has reported an Overheat condition: System will shutdown"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeCurrentTemperature = this.trap.VarBinds.index(2).Value
    - check: this.trap.SpecificTrap == 7
      processors:
        - label: extreme_fanfailed
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "One or more of the Cooling Fans has Failed"
            root.out.event.category.name = "Fan Status"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeFanNumber = this.trap.VarBinds.index(2).Value
    - check: this.trap.SpecificTrap == 8
      processors:
        - label: extreme_fan_ok
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Fan Status"
            root.out.object.name = ""
            root.out.event.message = "Fan is now operating Correctly"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeFanNumber = this.trap.VarBinds.index(2).Value
    - check: this.trap.SpecificTrap == 9
      processors:
        - label: extreme_invalid_login_attempt
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "User login via telnet Refused: Incorrect username or password"
            root.out.event.category.name = "Login"
            root.out.object.name = ""

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 10
      processors:
        - label: extreme_power_supply_fail
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Power Supply Status"
            root.out.object.name = ""
            root.out.event.message = "One or more Power Sources to this agent has Failed"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremePowerSupplyNumber = this.trap.VarBinds.index(2).Value
    - check: this.trap.SpecificTrap == 11
      processors:
        - label: extreme_power_supply_good
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Power Supply Status"
            root.out.object.name = ""
            root.out.event.message = "One or more previously bad Power Sources has come back to life"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremePowerSupplyNumber = this.trap.VarBinds.index(2).Value
    - check: this.trap.SpecificTrap == 12
      processors:
        - label: extreme_rps_alarm
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Redundant Power Supply Status"
            root.out.object.name = ""
            root.out.event.message = "Redundant Power Supply device indicating an Alarm"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 13
      processors:
        - label: extreme_rps_no_alarm
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.message = "Redundant Power Supply device no longer indicating an Alarm"
            root.out.event.category.name = "Redundant Power Supply Status"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 14
      processors:
        - label: extreme_smart_trap
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Smart Trap"
            root.out.object.name = ""
            root.out.event.message = "New entry has been created in the extremeSmartTrapInstanceTable"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 15
      processors:
        - label: extreme_module_state_changed
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = this.trap.VarBinds.index(1).Value
            root.out.event.category.name = "Module Status"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.extremeSlotNumber = this.trap.VarBinds.index(1).Value
            root.out.extreme.extremeSlotModuleConfiguredType = this.trap.VarBinds.index(2).Value.enum_enrich(".1.3.6.1.4.1.1916.1.1.2.2.1.3")
            root.out.extreme.extremeSlotModuleInsertedType = this.trap.VarBinds.index(3).Value.enum_enrich(".1.3.6.1.4.1.1916.1.1.2.2.1.4")
            root.out.extreme.extremeSlotModuleState = this.trap.VarBinds.index(4).Value.enum_enrich(".1.3.6.1.4.1.1916.1.1.2.2.1.5")
        - label: extreme_module_state_changed_nested_switch
          switch:
            - check: this.trap.VarBinds.index(4).Value == 1
              processors:
                - label: extreme_module_state_changed_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Not Present"
            - check: this.trap.VarBinds.index(4).Value == 2
              processors:
                - label: extreme_module_state_changed_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Testing"
            - check: this.trap.VarBinds.index(4).Value == 3
              processors:
                - label: extreme_module_state_changed_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Mismatch"
            - check: this.trap.VarBinds.index(4).Value == 4
              processors:
                - label: extreme_module_state_changed_nested_switch_4
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Failed"
            - check: this.trap.VarBinds.index(4).Value == 5
              processors:
                - label: extreme_module_state_changed_nested_switch_5
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Operational"
            - check: this.trap.VarBinds.index(4).Value == 6
              processors:
                - label: extreme_module_state_changed_nested_switch_6
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Power Down"
            - check: this.trap.VarBinds.index(4).Value == 7
              processors:
                - label: extreme_module_state_changed_nested_switch_7
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Module ( $Module ) in slot " + this.trap.VarBinds.index(1).Value + " Unknown"
            - processors:
                - label: extreme_module_state_changed_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: extreme_module_state_changed_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 17
      processors:
        - label: extreme_esrp_state_change
          mapping: |-
            #!blobl
            root = this

            root.out.object.name = ""
            root.out.event.category.name = "ESRP Status"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeVlanIfIndex = this.trap.VarBinds.index(2).Value
            root.out.extreme.extremeVlanIfDescr = this.trap.VarBinds.index(3).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeEsrpGroup = this.trap.VarBinds.index(4).Value
            root.out.extreme.extremeEsrpState = this.trap.VarBinds.index(5).Value.enum_enrich(".1.3.6.1.4.1.1916.1.12.2.1.5")
            root.out.extreme.extremeEsrpNetAddress = this.trap.VarBinds.index(6).Value
            root.out.extreme.ifPhysAddress = this.trap.VarBinds.index(7).Value
            root.out.extreme.extremeEsrpActivePorts = this.trap.VarBinds.index(8).Value
            root.out.extreme.extremeEsrpInternalActivePorts = this.trap.VarBinds.index(9).Value
            root.out.extreme.extremeEsrpTrackedActivePorts = this.trap.VarBinds.index(10).Value
            root.out.extreme.extremeEsrpTrackedIpRoutes = this.trap.VarBinds.index(11).Value
        - label: extreme_esrp_state_change_nested_switch
          switch:
            - check: this.trap.VarBinds.index(5).Value == 1
              processors:
                - label: extreme_esrp_state_change_nested_switch_1
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Extreme Standby Routing Protocol(ESRP) state: Neutral"
            - check: this.trap.VarBinds.index(5).Value == 2
              processors:
                - label: extreme_esrp_state_change_nested_switch_2
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Extreme Standby Routing Protocol(ESRP) state: Master"
            - check: this.trap.VarBinds.index(5).Value == 3
              processors:
                - label: extreme_esrp_state_change_nested_switch_3
                  mapping: |
                    #!blobl
                    root = this

                    root.out.event.message = "Extreme Standby Routing Protocol(ESRP) state: Slave"
            - processors:
                - label: extreme_esrp_state_change_nested_switch_default
                  mapping: |+
                    #!blobl
                    root = this

        - label: extreme_esrp_state_change_after_switch
          mapping: |+
            #!blobl
            root = this

    - check: this.trap.SpecificTrap == 18
      processors:
        - label: extreme_slb_unit_added
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Server Load Balancer"
            root.out.object.name = ""
            root.out.event.message = "Server Load Balancer activated a group of virtual servers that it normally would not activate"
    - check: this.trap.SpecificTrap == 19
      processors:
        - label: extreme_slb_unit_removed
          mapping: |
            #!blobl
            root = this

            root.out.event.category.name = "Server Load Balancer"
            root.out.object.name = ""
            root.out.event.message = "Server Load Balancer deactivated a group of virtual servers that it normally has active"
    - check: this.trap.SpecificTrap == 20
      processors:
        - label: extreme_edp_neighbor_added
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Extreme Discovery Protocol"
            root.out.object.name = this.trap.VarBinds.index(2).Value
            root.out.event.message = "Node discovers a new neighbor ( " + this.trap.VarBinds.index(2).Value + " ) via Extreme Discovery Protocol(EDP)"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.extremeEdpPortIfIndex = this.trap.VarBinds.index(1).Value
            root.out.extreme.extremeEdpNeighborId = this.trap.VarBinds.index(2).Value
            root.out.extreme.extremeEdpEntryAge = this.trap.VarBinds.index(3).Value
            root.out.extreme.ifAlias = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()
            root.out.extreme.ifDescr = this.trap.VarBinds.index(5).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 21
      processors:
        - label: extreme_edp_neighbor_removed
          mapping: |-
            #!blobl
            root = this

            root.out.event.category.name = "Extreme Discovery Protocol"
            root.out.object.name = this.trap.VarBinds.index(2).Value
            root.out.event.message = "No EDP updates received, neighbor ( " + this.trap.VarBinds.index(2).Value + " ) entry is aged out by the device"

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.extremeEdpPortIfIndex = this.trap.VarBinds.index(1).Value
            root.out.extreme.extremeEdpNeighborId = this.trap.VarBinds.index(2).Value
            root.out.extreme.extremeEdpEntryAge = this.trap.VarBinds.index(3).Value
            root.out.extreme.ifAlias = this.trap.VarBinds.index(4).Value.snmp_v2_tc_display_string()
            root.out.extreme.ifDescr = this.trap.VarBinds.index(5).Value.snmp_v2_tc_display_string()
    - check: this.trap.SpecificTrap == 22
      processors:
        - label: extreme_cpu_health_check_failed
          mapping: |-
            #!blobl
            root = this

            root.out.event.message = "CPU HealthCheck has failed"
            root.out.event.category.name = "CPU Health"
            root.out.object.name = this.trap.VarBinds.index(2).Value

            root.out.extreme.sysUpTime = this.trap.VarBinds.index(0).Value
            root.out.extreme.sysDescr = this.trap.VarBinds.index(1).Value.snmp_v2_tc_display_string()
            root.out.extreme.extremeSlotNumber = this.trap.VarBinds.index(2).Value
    - processors:
        - label: default
          mapping: |
            #!blobl,
            root = this
            root.out.event.category.name = "Unknown Trap"
