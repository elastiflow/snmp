- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "Juniper JUNIPER-MIB"
- switch:
  - check: this.trap.SpecificTrap == 1
    # jnxPowerSupplyFailure
    #
    # the specified power supply in the chassis has been in the failure (bad DC output) condition
    #
    # jnxContentsContainerIndex (Integer32) - The associated jnxContainersIndex in the jnxContainersTable.
    # jnxContentsL1Index (Integer32) - The level one index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL2Index (Integer32) - The level two index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL3Index (Integer32) - The level three index of the container. Zero if unavailable or inapplicable.
    # jnxContentsDescr (DisplayString) - The name or detailed description of this subject.
    # jnxOperatingState (INTEGER) - The operating state of this subject.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds = "unexpected"
          if this.trap.VarBinds.length() > 4 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.6") {
              meta varbinds = "basic"
              if this.trap.VarBinds.length() > 5 {
                if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.13.1.6") {
                  meta varbinds = "full"
          }}}}}}}}

      - switch:
        - check: metadata("varbinds") != "unexpected"
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxContentsContainerIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxContentsL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxContentsL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxContentsL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxContentsDescr = this.trap.VarBinds.index(4).Value.snmp_display_string()

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.8.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "content: " + root.out.juniper.jnxContentsDescr

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyFailure"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyFailure"
                root.out.event.category.name = "power supply state"
                root.out.event.message = "power supply failure"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

                if metadata("varbinds") == "full" {
                  root.out.juniper.jnxOperatingState = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.13.1.6")
                  root.out.event.message = root.out.event.message + ": " + root.out.juniper.jnxOperatingState
                }

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyFailure"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyFailure-unknown"
              root.out.event.category.name = "power supply state"
              root.out.event.message = "power supply failure - UNEXPECTED VARBINDS for jnxPowerSupplyFailure trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 2
    # jnxFanFailure
    #
    # the specified cooling fan or impeller in the chassis has been in the failure (not spinning) condition
    #
    # jnxContentsContainerIndex (Integer32) - The associated jnxContainersIndex in the jnxContainersTable.
    # jnxContentsL1Index (Integer32) - The level one index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL2Index (Integer32) - The level two index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL3Index (Integer32) - The level three index of the container. Zero if unavailable or inapplicable.
    # jnxContentsDescr (DisplayString) - The name or detailed description of this subject.
    # jnxOperatingState (INTEGER) - The operating state of this subject.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds = "unexpected"
          if this.trap.VarBinds.length() > 4 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.6") {
              meta varbinds = "basic"
              if this.trap.VarBinds.length() > 5 {
                if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.13.1.6") {
                  meta varbinds = "full"
          }}}}}}}}

      - switch:
        - check: metadata("varbinds") != "unexpected"
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxContentsContainerIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxContentsL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxContentsL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxContentsL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxContentsDescr = this.trap.VarBinds.index(4).Value.snmp_display_string()

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.8.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "content: " + root.out.juniper.jnxContentsDescr

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFanFailure"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFanFailure"
                root.out.event.category.name = "fan state"
                root.out.event.message = "fan failure"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

                if metadata("varbinds") == "full" {
                  root.out.juniper.jnxOperatingState = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.13.1.6")
                  root.out.event.message = root.out.event.message + ": " + root.out.juniper.jnxOperatingState
                }

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFanFailure"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFanFailure-unknown"
              root.out.event.category.name = "fan state"
              root.out.event.message = "fan failure - UNEXPECTED VARBINDS for jnxFanFailure trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 3
    # jnxOverTemperature
    #
    # the specified hardware component in the chassis has experienced over temperature condition.
    #
    # jnxContentsContainerIndex (Integer32) - The associated jnxContainersIndex in the jnxContainersTable.
    # jnxContentsL1Index (Integer32) - The level one index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL2Index (Integer32) - The level two index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL3Index (Integer32) - The level three index of the container. Zero if unavailable or inapplicable.
    # jnxContentsDescr (DisplayString) - The name or detailed description.
    # jnxOperatingTemp (Integer32) - The temperature in Celsius (degrees C). Zero if unavailable or inapplicable.
    # jnxOperatingTemperature (Integer32) - The temperature in Celsius (degrees C). Zero if unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds = "unexpected"
          if this.trap.VarBinds.length() > 4 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.6") {
              meta varbinds = "basic"
              if this.trap.VarBinds.length() > 5 {
                if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.13.1.7") {
                  meta varbinds = "option"
                  if this.trap.VarBinds.length() > 6 {
                    if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.13.1.30") {
                      meta varbinds = "full"
          }}}}}}}}}}

      - switch:
        - check: metadata("varbinds") != "unexpected"
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxContentsContainerIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxContentsL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxContentsL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxContentsL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxContentsDescr = this.trap.VarBinds.index(4).Value.snmp_display_string()

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.8.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "content: " + root.out.juniper.jnxContentsDescr

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxOverTemperature"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxOverTemperature"
                root.out.event.category.name = "temperature threshold"
                root.out.event.message = "temperature high"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

                if metadata("varbinds") == "full" {
                  root.out.juniper.jnxOperatingTemperature = this.trap.VarBinds.index(6).Value
                  root.out.event.message = root.out.event.message + ": " + root.out.juniper.jnxOperatingTemperature.string() + "C"
                } else if metadata("varbinds") == "option" {
                  root.out.juniper.jnxOperatingTemp = this.trap.VarBinds.index(5).Value
                  root.out.event.message = root.out.event.message + ": " + root.out.juniper.jnxOperatingTemp.string() + "C"
                }

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxOverTemperature"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxOverTemperature-unknown"
              root.out.event.category.name = "temperature threshold"
              root.out.event.message = "temperature high - UNEXPECTED VARBINDS for jnxOverTemperature trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 4
    # jnxRedundancySwitchover
    #
    # The specified hardware component in the chassis has experienced a redundancy switchover event defined as a change
    # in state of jnxRedundancyState from master to backup or vice versa.
    #
    # jnxContentsContainerIndex (Integer32) - The associated jnxContainersIndex in the jnxContainersTable.
    # jnxContentsL1Index (Integer32) - The level one index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL2Index (Integer32) - The level two index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL3Index (Integer32) - The level three index of the container. Zero if unavailable or inapplicable.
    # jnxContentsDescr (DisplayString) - The name or detailed description of this subject.
    # jnxRedundancyConfig (INTEGER) - The election priority of redundancy configuration for this subject. The value
    #   'notApplicable' means no specific instance is configured to be master or backup; whichever component boots up
    #   first becomes a master.
    # jnxRedundancyState (INTEGER) - The current running state for this subject.
    # jnxRedundancySwitchoverCount (Counter32) - The total number of switchover since the routing engine is up and
    #   running. The switchover is defined as a change in state of jnxRedundancyState from master to backup or vice
    #   versa.
    # jnxRedundancySwitchoverTime (TimeStamp) - The value of sysUpTime when the jnxRedundancyState was last switched
    #   over from master to backup or vice versa. Zero if unknown or never switched over.
    # jnxRedundancySwitchoverReason (INTEGER) - The reason of the last switchover for this subject.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 9 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.6") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.14.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.14.1.7") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.14.1.8") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.14.1.9") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.14.1.10") {
              meta varbinds_ok = true
          }}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxContentsContainerIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxContentsL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxContentsL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxContentsL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxContentsDescr = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxRedundancyConfig = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.14.1.6")
                root.out.juniper.jnxRedundancyState = this.trap.VarBinds.index(6).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.14.1.7")
                root.out.juniper.jnxRedundancySwitchoverCount = this.trap.VarBinds.index(7).Value
                root.out.juniper.jnxRedundancySwitchoverTime = this.trap.VarBinds.index(8).Value
                root.out.juniper.jnxRedundancySwitchoverReason = this.trap.VarBinds.index(9).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.14.1.10")

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.8.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "content: " + root.out.juniper.jnxContentsDescr

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxRedundancySwitchover"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxRedundancySwitchover"
                root.out.event.category.name = "redundancy state"
                root.out.event.message = "redundancy switchover to " + root.out.juniper.jnxRedundancyState + ": " + root.out.juniper.jnxRedundancySwitchoverReason
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxRedundancySwitchover"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxRedundancySwitchover-unknown"
              root.out.event.category.name = "redundancy state"
              root.out.event.message = "redundancy switchover - UNEXPECTED VARBINDS for jnxRedundancySwitchover trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 5
    # jnxFruRemoval
    #
    # FRU (Field Replaceable Unit) has been removed from the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval"
                root.out.event.category.name = "FRU installation state"
                root.out.event.message = root.out.juniper.jnxFruType + " FRU removed"
                root.out.event.severity.code = 1
                root.out.event.severity.level = "Alert"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval-unknown"
              root.out.event.category.name = "FRU installation state"
              root.out.event.message = "FRU removed - UNEXPECTED VARBINDS for jnxFruRemoval trap!"
              root.out.event.severity.code = 1
              root.out.event.severity.level = "Alert"

  - check: this.trap.SpecificTrap == 6
    # jnxFruInsertion
    #
    # FRU (Field Replaceable Unit) has been inserted into the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruInsertion"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruInsertion"
                root.out.event.category.name = "FRU installation state"
                root.out.event.message = root.out.juniper.jnxFruType + " FRU inserted"
                root.out.event.severity.code = 6
                root.out.event.severity.level = "Informational"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruRemoval-unknown"
              root.out.event.category.name = "FRU installation state"
              root.out.event.message = "FRU inserted - UNEXPECTED VARBINDS for jnxFruRemoval trap!"
              root.out.event.severity.code = 5
              root.out.event.severity.level = "Notice"

  - check: this.trap.SpecificTrap == 7
    # jnxFruPowerOff
    #
    # FRU (Field Replaceable Unit) has been powered off in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    # jnxFruOfflineReason (INTEGER) - The offline reason.
    # jnxFruLastPowerOff (TimeStamp) - The value of sysUpTime when last powered off. Zero if unavailable or
    #   inapplicable.
    # jnxFruLastPowerOn (TimeStamp) - The value of sysUpTime when last powered on. Zero if unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 9 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.10") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.11") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.12") {
              meta varbinds_ok = true
          }}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value
                root.out.juniper.jnxFruOfflineReason = this.trap.VarBinds.index(7).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.10")
                root.out.juniper.jnxFruLastPowerOff = this.trap.VarBinds.index(8).Value
                root.out.juniper.jnxFruLastPowerOn = this.trap.VarBinds.index(9).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOff"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOff"
                root.out.event.category.name = "FRU power state"
                root.out.event.message = root.out.juniper.jnxFruType + " FRU powered off: " + root.out.juniper.jnxFruOfflineReason
                root.out.event.severity.code = 1
                root.out.event.severity.level = "Alert"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOff"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOff-unknown"
              root.out.event.category.name = "FRU power state"
              root.out.event.message = "FRU powered off - UNEXPECTED VARBINDS for jnxFruPowerOff trap!"
              root.out.event.severity.code = 1
              root.out.event.severity.level = "Alert"

  - check: this.trap.SpecificTrap == 8
    # jnxFruPowerOn
    #
    # FRU (Field Replaceable Unit) has been powered on in the chassis.
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    # jnxFruOfflineReason (INTEGER) - The offline reason.
    # jnxFruLastPowerOff (TimeStamp) - The value of sysUpTime when last powered off. Zero if unavailable or
    #   inapplicable.
    # jnxFruLastPowerOn (TimeStamp) - The value of sysUpTime when last powered on. Zero if unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 9 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.10") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.11") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.12") {
              meta varbinds_ok = true
          }}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value
                root.out.juniper.jnxFruOfflineReason = this.trap.VarBinds.index(7).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.10")
                root.out.juniper.jnxFruLastPowerOff = this.trap.VarBinds.index(8).Value
                root.out.juniper.jnxFruLastPowerOn = this.trap.VarBinds.index(9).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOn"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOn"
                root.out.event.category.name = "FRU power state"
                root.out.event.message = root.out.juniper.jnxFruType + " FRU powered on: " + root.out.juniper.jnxFruOfflineReason
                root.out.event.severity.code = 6
                root.out.event.severity.level = "Informational"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOn"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruPowerOn-unknown"
              root.out.event.category.name = "FRU power state"
              root.out.event.message = "FRU powered on - UNEXPECTED VARBINDS for jnxFruPowerOn trap!"
              root.out.event.severity.code = 5
              root.out.event.severity.level = "Notice"

  - check: this.trap.SpecificTrap == 9
    # jnxFruFailed
    #
    # FRU (Field Replaceable Unit) has failed in the chassis. Most probably this is due to some hard error such as fru
    # is not powering up or not able to load ukernel. In these cases, fru is replaced.
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruFailed"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruFailed"
                root.out.event.category.name = "FRU state"
                root.out.event.message = root.out.juniper.jnxFruType + " failed"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruFailed"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruFailed-unknown"
              root.out.event.category.name = "FRU state"
              root.out.event.message = "FRU failed - UNEXPECTED VARBINDS for jnxFruFailed trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 10
    # jnxFruOffline
    #
    # FRU (Field Replaceable Unit) has gone offline in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    # jnxFruOfflineReason (INTEGER) - The offline reason.
    # jnxFruLastPowerOff (TimeStamp) - The value of sysUpTime when last powered off. Zero if unavailable or
    #   inapplicable.
    # jnxFruLastPowerOn (TimeStamp) - The value of sysUpTime when last powered on. Zero if unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 9 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.10") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.11") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.12") {
              meta varbinds_ok = true
          }}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value
                root.out.juniper.jnxFruOfflineReason = this.trap.VarBinds.index(7).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.10")
                root.out.juniper.jnxFruLastPowerOff = this.trap.VarBinds.index(8).Value
                root.out.juniper.jnxFruLastPowerOn = this.trap.VarBinds.index(9).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOffline"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOffline"
                root.out.event.category.name = "FRU state"
                root.out.event.message = root.out.juniper.jnxFruType + " offline: " + root.out.juniper.jnxFruOfflineReason
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOffline"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOffline-unknown"
              root.out.event.category.name = "FRU state"
              root.out.event.message = "FRU offline - UNEXPECTED VARBINDS for jnxFruOffline trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 11
    # jnxFruOnline
    #
    # FRU (Field Replaceable Unit) has gone online in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOnline"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOnline"
                root.out.event.category.name = "FRU state"
                root.out.event.message = root.out.juniper.jnxFruType + " online"
                root.out.event.severity.code = 6
                root.out.event.severity.level = "Informational"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOnline"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruOnline-unknown"
              root.out.event.category.name = "FRU state"
              root.out.event.message = "FRU online - UNEXPECTED VARBINDS for jnxFruOnline trap!"
              root.out.event.severity.code = 5
              root.out.event.severity.level = "Notice"

  - check: this.trap.SpecificTrap == 12
    # jnxFruCheck
    #
    # FRU (Field Replaceable Unit) has encountered some operational errors and gone into check state in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruCheck"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruCheck"
                root.out.event.category.name = "FRU state"
                root.out.event.message = root.out.juniper.jnxFruType + " errors, in check state"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruCheck"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFruCheck-unknown"
              root.out.event.category.name = "FRU state"
              root.out.event.message = "FRU errors, in check state - UNEXPECTED VARBINDS for jnxFruCheck trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 13
    # jnxFEBSwitchover
    #
    # FEB (Forwarding Engine Board) has switched over
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFEBSwitchover"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFEBSwitchover"
                root.out.event.category.name = "FEB switchover state"
                root.out.event.message = root.out.juniper.jnxFruType + " switchover"
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFEBSwitchover"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFEBSwitchover-unknown"
              root.out.event.category.name = "FEB switchover state"
              root.out.event.message = "FEB switchover - UNEXPECTED VARBINDS for jnxFEBSwitchover trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 14
    # jnxHardDiskFailed
    #
    # Routing Engine has encountered some operational errors and gone into failed state in the chassis.
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskFailed"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskFailed"
                root.out.event.category.name = "hard disk state"
                root.out.event.message = root.out.juniper.jnxFruType + " hard disk failed"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskFailed"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskFailed-unknown"
              root.out.event.category.name = "hard disk state"
              root.out.event.message = "hard disk failed - UNEXPECTED VARBINDS for jnxHardDiskFailed trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 15
    # jnxHardDiskMissing
    #
    # hard disk in the specified outing Engine is missing from boot device list
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskMissing"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskMissing"
                root.out.event.category.name = "hard disk state"
                root.out.event.message = root.out.juniper.jnxFruType + " hard disk missing from boot device list"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskMissing"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxHardDiskMissing-unknown"
              root.out.event.category.name = "hard disk state"
              root.out.event.message = "hard disk missing from boot device list - UNEXPECTED VARBINDS for jnxHardDiskMissing trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 16
    # jnxBootFromBackup
    #
    # routing-engine/member has booted from the back up root partition
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxBootFromBackup"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxBootFromBackup"
                root.out.event.category.name = "boot state"
                root.out.event.message = root.out.juniper.jnxFruType + " routing-engine/member booted from backup root partition"
                root.out.event.severity.code = 4
                root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxBootFromBackup"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxBootFromBackup-unknown"
              root.out.event.category.name = "boot state"
              root.out.event.message = "routing-engine/member booted from backup root partition - UNEXPECTED VARBINDS for jnxBootFromBackup trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 17
    # jnxFmLinkErr
    #
    # link errors
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmLinkErr"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmLinkErr"
                root.out.event.category.name = "FM link state"
                root.out.event.message = root.out.juniper.jnxFruType + " link errors"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmLinkErr"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmLinkErr-unknown"
              root.out.event.category.name = "FM link state"
              root.out.event.message = "FM link errors - UNEXPECTED VARBINDS for jnxFmLinkErr trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 18
    # jnxFmCellDropErr
    #
    # cell drop errors
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmCellDropErr"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmCellDropErr"
                root.out.event.category.name = "FM cell state"
                root.out.event.message = root.out.juniper.jnxFruType + " cell drop errors"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmCellDropErr"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmCellDropErr-unknown"
              root.out.event.category.name = "FM cell state"
              root.out.event.message = "FM cell drop errors - UNEXPECTED VARBINDS for jnxFmCellDropErr trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 19
    # jnxExtSrcLockLost
    #
    # a lock for an external clock source has been lost
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxExtSrcLockLost"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxExtSrcLockLost"
                root.out.event.category.name = "external clock source state"
                root.out.event.message = root.out.juniper.jnxFruType + " external clock source lost"
                root.out.event.severity.code = 4
                root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxExtSrcLockLost"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxExtSrcLockLost-unknown"
              root.out.event.category.name = "external clock source state"
              root.out.event.message = "external clock source lost - UNEXPECTED VARBINDS for jnxExtSrcLockLost trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 20
    # jnxPlaneOffline
    #
    # Fabric plane has gone offline in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    # jnxFruOfflineReason (INTEGER) - The offline reason.
    # jnxFruLastPowerOff (TimeStamp) - The value of sysUpTime when last powered off. Zero if unavailable or
    #   inapplicable.
    # jnxFruLastPowerOn (TimeStamp) - The value of sysUpTime when last powered on. Zero if unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 9 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.10") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.11") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.12") {
              meta varbinds_ok = true
          }}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value
                root.out.juniper.jnxFruOfflineReason = this.trap.VarBinds.index(7).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.10")
                root.out.juniper.jnxFruLastPowerOff = this.trap.VarBinds.index(8).Value
                root.out.juniper.jnxFruLastPowerOn = this.trap.VarBinds.index(9).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOffline"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOffline"
                root.out.event.category.name = "fabric plane state"
                root.out.event.message = root.out.juniper.jnxFruType + " fabric plane offline: " + root.out.juniper.jnxFruOfflineReason
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOffline"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOffline-unknown"
              root.out.event.category.name = "fabric plane state"
              root.out.event.message = "fabric plane offline - UNEXPECTED VARBINDS for jnxPlaneOffline trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 21
    # jnxPlaneOnline
    #
    # Fabric Plane has gone online in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOnline"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOnline"
                root.out.event.category.name = "fabric plane state"
                root.out.event.message = root.out.juniper.jnxFruType + " fabric plane online"
                root.out.event.severity.code = 6
                root.out.event.severity.level = "Informational"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOnline"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneOnline-unknown"
              root.out.event.category.name = "fabric plane state"
              root.out.event.message = "fabric plane online - UNEXPECTED VARBINDS for jnxPlaneOnline trap!"
              root.out.event.severity.code = 5
              root.out.event.severity.level = "Notice"

  - check: this.trap.SpecificTrap == 22
    # jnxPlaneCheck
    #
    # Fabric plane has encountered some operational errors and gone into check state in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneCheck"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneCheck"
                root.out.event.category.name = "fabric plane state"
                root.out.event.message = root.out.juniper.jnxFruType + " fabric plane errors, in check state"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneCheck"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneCheck-unknown"
              root.out.event.category.name = "fabric plane state"
              root.out.event.message = "fabric plane errors, in check state - UNEXPECTED VARBINDS for jnxPlaneCheck trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 23
    # jnxPlaneFault
    #
    # Fabric plane has encountered some operational errors and gone into fault state in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneFault"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneFault"
                root.out.event.category.name = "fabric plane state"
                root.out.event.message = root.out.juniper.jnxFruType + " fabric plane errors, in fault state"
                root.out.event.severity.code = 2
                root.out.event.severity.level = "Critical"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneFault"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPlaneFault-unknown"
              root.out.event.category.name = "fabric plane state"
              root.out.event.message = "fabric plane errors, in fault state - UNEXPECTED VARBINDS for jnxPlaneFault trap!"
              root.out.event.severity.code = 2
              root.out.event.severity.level = "Critical"

  - check: this.trap.SpecificTrap == 24
    # jnxPowerSupplyInputFailure
    #
    # the specified power supply's input feed in the chassis has been in the failure condition
    #
    # jnxContentsContainerIndex (Integer32) - The associated jnxContainersIndex in the jnxContainersTable.
    # jnxContentsL1Index (Integer32) - The level one index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL2Index (Integer32) - The level two index of the container. Zero if unavailable or inapplicable.
    # jnxContentsL3Index (Integer32) - The level three index of the container. Zero if unavailable or inapplicable.
    # jnxContentsDescr (DisplayString) - The name or detailed description of this subject.
    # jnxOperatingState (INTEGER) - The operating state of this subject.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds = "unexpected"
          if this.trap.VarBinds.length() > 4 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.8.1.6") {
              meta varbinds = "basic"
              if this.trap.VarBinds.length() > 5 {
                if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.13.1.6") {
                  meta varbinds = "full"
          }}}}}}}}

      - switch:
        - check: metadata("varbinds") != "unexpected"
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxContentsContainerIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxContentsL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxContentsL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxContentsL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxContentsDescr = this.trap.VarBinds.index(4).Value.snmp_display_string()

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.8.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "content: " + root.out.juniper.jnxContentsDescr

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyInputFailure"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyInputFailure"
                root.out.event.category.name = "power supply input state"
                root.out.event.message = "power supply input feed failure"
                root.out.event.severity.code = 1
                root.out.event.severity.level = "Alert"

                if metadata("varbinds") == "full" {
                  root.out.juniper.jnxOperatingState = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.13.1.6")
                  root.out.event.message = root.out.event.message + ": " + root.out.juniper.jnxOperatingState
                }

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyInputFailure"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxPowerSupplyInputFailure-unknown"
              root.out.event.category.name = "power supply input state"
              root.out.event.message = "power supply input feed failure - UNEXPECTED VARBINDS for jnxPowerSupplyInputFailure trap!"
              root.out.event.severity.code = 1
              root.out.event.severity.level = "Alert"

  - check: this.trap.SpecificTrap == 25
    # jnxFmAsicErr
    #
    # errors in a switching device within the fabric
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmAsicErr"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmAsicErr"
                root.out.event.category.name = "FM ASIC state"
                root.out.event.message = root.out.juniper.jnxFruType + " ASIC switching device errors"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmAsicErr"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmAsicErr-unknown"
              root.out.event.category.name = "FM ASIC state"
              root.out.event.message = "ASIC switching device errors - UNEXPECTED VARBINDS for jnxFmAsicErr trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 26
    # jnxMountVarOffHardDiskFailed
    #
    # mount of /var failed off harddisk, emergency /var created
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxMountVarOffHardDiskFailed"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxMountVarOffHardDiskFailed"
                root.out.event.category.name = "file system state"
                root.out.event.message = root.out.juniper.jnxFruType + " file system /var failed, emergency /var created"
                root.out.event.severity.code = 1
                root.out.event.severity.level = "Alert"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxMountVarOffHardDiskFailed"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxMountVarOffHardDiskFailed-unknown"
              root.out.event.category.name = "file system state"
              root.out.event.message = "file system /var failed, emergency /var created - UNEXPECTED VARBINDS for jnxMountVarOffHardDiskFailed trap!"
              root.out.event.severity.code = 1
              root.out.event.severity.level = "Alert"

  - check: this.trap.SpecificTrap == 27
    # jnxFmHealthChkErr
    #
    # health check errors
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmHealthChkErr"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmHealthChkErr"
                root.out.event.category.name = "FM health check state"
                root.out.event.message = root.out.juniper.jnxFruType + " health check errors"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmHealthChkErr"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxFmHealthChkErr-unknown"
              root.out.event.category.name = "FM health check state"
              root.out.event.message = "FM health check errors - UNEXPECTED VARBINDS for jnxFmHealthChkErr trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 28
    # jnxAlarmPortInput
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxAlarmPortInput"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxAlarmPortInput"
                root.out.event.category.name = "alarm port state"
                root.out.event.message = root.out.juniper.jnxFruType + " alarm port input"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxAlarmPortInput"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxAlarmPortInput-unknown"
              root.out.event.category.name = "alarm port state"
              root.out.event.message = "alarm port input - UNEXPECTED VARBINDS for jnxAlarmPortInput trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 29
    # jnxUnsupportedFru
    #
    # the Unsupported Fru has been inserted in the chassis
    #
    # jnxFruContentsIndex (Integer32) - The associated jnxContentsContainerIndex in the jnxContentsTable.
    # jnxFruL1Index (Integer32) - The level one index. Zero if unavailable or inapplicable.
    # jnxFruL2Index (Integer32) - The level two index. Zero if unavailable or inapplicable.
    # jnxFruL3Index (Integer32) - The level three index. Zero if unavailable or inapplicable.
    # jnxFruName (DisplayString) - The name or detailed description of this subject.
    # jnxFruType (INTEGER) - The FRU type for this subject.
    # jnxFruSlot (Integer32) - The slot number of this subject. This is equivalent to jnxFruL1Index in meaning. Zero if
    #   unavailable or inapplicable.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 6 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.1") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.2") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.3") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.4") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.5") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.6") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.4.1.2636.3.1.15.1.7") {
              meta varbinds_ok = true
          }}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.juniper.jnxFruContentsIndex = this.trap.VarBinds.index(0).Value
                root.out.juniper.jnxFruL1Index = this.trap.VarBinds.index(1).Value
                root.out.juniper.jnxFruL2Index = this.trap.VarBinds.index(2).Value
                root.out.juniper.jnxFruL3Index = this.trap.VarBinds.index(3).Value
                root.out.juniper.jnxFruName = this.trap.VarBinds.index(4).Value.snmp_display_string()
                root.out.juniper.jnxFruType = this.trap.VarBinds.index(5).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.2636.3.1.15.1.6")
                root.out.juniper.jnxFruSlot = this.trap.VarBinds.index(6).Value

                root.out.object.name = "JUNIPER-MIB::jnxFilledEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.2636.3.1.15.1.1")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "FRU: " + root.out.juniper.jnxFruName + ", slot: " + root.out.juniper.jnxFruSlot.string()

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxUnsupportedFru"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxUnsupportedFru"
                root.out.event.category.name = "FRU state"
                root.out.event.message = root.out.juniper.jnxFruType + " unsupported"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxUnsupportedFru"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxUnsupportedFru-unknown"
              root.out.event.category.name = "FRU state"
              root.out.event.message = "FRU unsupported - UNEXPECTED VARBINDS for jnxUnsupportedFru trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 30
    # jnxDyingGasp
    #
    # jnxDyingGasp trap signifies that system is going down due to power failure.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = true
          if this.trap.VarBinds.length() > 0 {
              meta varbinds_ok = false
          }

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxDyingGasp"
                root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxDyingGasp"
                root.out.event.category.name = "chassis state"
                root.out.event.message = "chassis dying gasp!"
                root.out.event.severity.code = 0
                root.out.event.severity.level = "Emergency"

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              if this.trap.VarBinds.length() > 12 {
                root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
                root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
                }
              if this.trap.VarBinds.length() > 13 {
                root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
                root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
                }
              if this.trap.VarBinds.length() > 14 {
                root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
                root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
                }
              if this.trap.VarBinds.length() > 15 {
                root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
                root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
                }
              }}}}}}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxDyingGasp"
              root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-jnxDyingGasp-unknown"
              root.out.event.category.name = "chassis state"
              root.out.event.message = "chassis dying gasp! - UNEXPECTED VARBINDS for jnxDyingGasp trap!"
              root.out.event.severity.code = 1
              root.out.event.severity.level = "Critical"

  - processors:
    - label: default
      mapping: |
        #!blobl
        root = this

        if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
          root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
          root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
          }
        if this.trap.VarBinds.length() > 1 {
          root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
          root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
          }
        if this.trap.VarBinds.length() > 2 {
          root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
          root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
          }
        if this.trap.VarBinds.length() > 3 {
          root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
          root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
          }
        if this.trap.VarBinds.length() > 4 {
          root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
          root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
          }
        if this.trap.VarBinds.length() > 5 {
          root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
          root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
          }
        if this.trap.VarBinds.length() > 6 {
          root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
          root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
          }
        if this.trap.VarBinds.length() > 7 {
          root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
          root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
          }
        if this.trap.VarBinds.length() > 8 {
          root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
          root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
            root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
          }
        if this.trap.VarBinds.length() > 9 {
          root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
          root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
            root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
          }
        if this.trap.VarBinds.length() > 10 {
          root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
          root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
            root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
          }
        if this.trap.VarBinds.length() > 11 {
          root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
          root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
            root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
          }
        if this.trap.VarBinds.length() > 12 {
          root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
          root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
            root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
          }
        if this.trap.VarBinds.length() > 13 {
          root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
          root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
            root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
          }
        if this.trap.VarBinds.length() > 14 {
          root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
          root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
            root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
          }
        if this.trap.VarBinds.length() > 15 {
          root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
          root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
            root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
          }
        }}}}}}}}}}}}}}}}

        root.out.event.class.name = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-unknown"
        root.out.event.id = "SNMPTRAP-JUNIPER-MIB-jnxChassisTraps-" + this.trap.SpecificTrap.string()
        root.out.event.category.name = "unknown specific trap"
        root.out.event.message = "unknown specific trap " + this.trap.SpecificTrap.string() + " from Juniper JUNIPER-MIB-jnxChassisTraps"
        root.out.event.severity.code = 4
        root.out.event.severity.level = "Warning"
