- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "IETF DIAL-CONTROL-MIB"
- switch:
  - check: this.trap.SpecificTrap == 1
    # dialCtlPeerCallInformation
    #
    # This trap/inform is sent to the manager whenever a successful call clears, or a failed call attempt is determined
    # to have ultimately failed. In the event that call retry is active, then this is after all retry attempts have
    # failed. However, only one such trap is sent in between successful call attempts; subsequent call attempts result
    # in no trap. ifOperStatus will return the operational status of the virtual interface associated with the peer to
    # whom this call was made to.
    #
    # callHistoryPeerId (INTEGER) - This is the Id value of the peer table entry to which this call was made.
    # callHistoryPeerIfIndex (INTEGER) - This is the ifIndex value of the peer table entry to which this call was made.
    # callHistoryLogicalIfIndex (Integer32) - This is the ifIndex value of the logical interface through which this call was made.
    # ifOperStatus (INTEGER) - The current operational state of the interface.
    # callHistoryPeerAddress (DisplayString) - The number this call was connected to.
    # callHistoryPeerSubAddress (DisplayString) - The subaddress this call was connected to.
    # callHistoryDisconnectCause (OCTET STRING) - The encoded network cause value associated with this call.
    # callHistoryConnectTime (TimeTicks) - The value of sysUpTime when the call was connected.
    # callHistoryDisconnectTime (TimeTicks) - The value of sysUpTime when the call was disconnected.
    # callHistoryInfoType (INTEGER) - The information type for this call.
    # callHistoryCallOrigin (INTEGER) - The call origin.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 10 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.3") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.4") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.5") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.2.1.2.2.1.8") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.1") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.2") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.6") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.8") {
            if this.trap.VarBinds.index(8).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.9") {
            if this.trap.VarBinds.index(9).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.12") {
            if this.trap.VarBinds.index(10).OID.has_prefix(".1.3.6.1.2.1.10.21.1.4.3.1.10") {
              meta varbinds_ok = true
          }}}}}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.ietf.callHistoryPeerId = this.trap.VarBinds.index(0).Value.string()
                root.out.ietf.callHistoryPeerIfIndex = this.trap.VarBinds.index(1).Value.string()
                root.out.ietf.callHistoryLogicalIfIndex = this.trap.VarBinds.index(2).Value.string()
                root.out.ietf.ifOperStatus = this.trap.VarBinds.index(3).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.2.2.1.8")
                root.out.ietf.callHistoryPeerAddress = this.trap.VarBinds.index(4).Value.snmp_octet_display_hint("255t")
                root.out.ietf.callHistoryPeerSubAddress = this.trap.VarBinds.index(5).Value.snmp_octet_display_hint("255t")
                root.out.ietf.callHistoryDisconnectCause = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                root.out.ietf.callHistoryConnectTime = this.trap.VarBinds.index(7).Value
                root.out.ietf.callHistoryDisconnectTime = this.trap.VarBinds.index(8).Value
                root.out.ietf.callHistoryInfoType = this.trap.VarBinds.index(9).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.10.21.1.4.3.1.12")
                root.out.ietf.callHistoryCallOrigin = this.trap.VarBinds.index(10).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.10.21.1.4.3.1.10")

                root.out.object.name = "DIAL-CONTROL-MIB::callActiveEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.2.1.10.21.1.4.3.1.3")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.callActiveEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.ietf.callActiveSetupTime = root.TEMP.callActiveEntry.index(0).number()
                root.out.ietf.callActiveIndex = root.TEMP.callActiveEntry.index(1).string()
                root.out.object.label = "peer: " + root.out.ietf.callHistoryPeerId + ", address: " + root.out.ietf.callHistoryPeerAddress
                if root.out.ietf.callHistoryPeerSubAddress.length() > 0 {
                  root.out.object.label = root.out.object.label + ", sub-address: " + root.out.ietf.callHistoryPeerSubAddress
                }

                root.out.event.class.name = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallInformation"
                root.out.event.id = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallInformation"
                root.out.event.category.name = "call state"
                root.out.event.message = root.out.ietf.callHistoryCallOrigin + " " + root.out.ietf.callHistoryInfoType + " call cleared/failed, cause code: " + root.out.ietf.callHistoryDisconnectCause
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              if this.trap.VarBinds.length() > 10 {
                root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
                root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
                }
              if this.trap.VarBinds.length() > 11 {
                root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
                root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
                }
              }}}}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallInformation"
              root.out.event.id = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallInformation-unknown"
              root.out.event.category.name = "call state"
              root.out.event.message = "call information - UNEXPECTED VARBINDS for dialCtlPeerCallInformation trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 2
    # dialCtlPeerCallSetup
    #
    # This trap/inform is sent to the manager whenever a call setup message is received or sent. ifOperStatus will
    # return the operational status of the virtual interface associated with the peer to whom this call was made to.
    #
    # callActivePeerId (INTEGER) - This is the Id value of the peer table entry to which this call was made.
    # callActivePeerIfIndex (INTEGER) - This is the ifIndex value of the peer table entry to which this call was made.
    # callActiveLogicalIfIndex (Integer32) - This is the ifIndex value of the logical interface through which this call was made.
    # ifOperStatus (INTEGER) - The current operational state of the interface.
    # callActivePeerAddress (DisplayString) - The number this call is connected to.
    # callActivePeerSubAddress (DisplayString) - The subaddress this call is connected to.
    # callActiveInfoType (INTEGER) - The information type for this call.
    # callActiveCallOrigin (INTEGER) - The call origin.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 7 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.5") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.6") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.7") {
            if this.trap.VarBinds.index(3).OID.has_prefix(".1.3.6.1.2.1.2.2.1.8") {
            if this.trap.VarBinds.index(4).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.3") {
            if this.trap.VarBinds.index(5).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.4") {
            if this.trap.VarBinds.index(6).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.12") {
            if this.trap.VarBinds.index(7).OID.has_prefix(".1.3.6.1.2.1.10.21.1.3.1.1.10") {
              meta varbinds_ok = true
          }}}}}}}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.ietf.callActivePeerId = this.trap.VarBinds.index(0).Value.string()
                root.out.ietf.callActivePeerIfIndex = this.trap.VarBinds.index(1).Value.string()
                root.out.ietf.callActiveLogicalIfIndex = this.trap.VarBinds.index(2).Value.string()
                root.out.ietf.ifOperStatus = this.trap.VarBinds.index(3).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.2.2.1.8")
                root.out.ietf.callActivePeerAddress = this.trap.VarBinds.index(4).Value.snmp_octet_display_hint("255t")
                root.out.ietf.callActivePeerSubAddress = this.trap.VarBinds.index(5).Value.snmp_octet_display_hint("255t")
                root.out.ietf.callActiveInfoType = this.trap.VarBinds.index(6).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.10.21.1.3.1.1.12")
                root.out.ietf.callActiveCallOrigin = this.trap.VarBinds.index(7).Value.snmp_int_enum_enrich(".1.3.6.1.2.1.10.21.1.3.1.1.10")

                root.out.object.name = "DIAL-CONTROL-MIB::callActiveEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.2.1.10.21.1.3.1.1.5")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.callActiveEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.ietf.callActiveSetupTime = root.TEMP.callActiveEntry.index(0).number()
                root.out.ietf.callActiveIndex = root.TEMP.callActiveEntry.index(1).string()
                root.out.object.label = "peer: " + root.out.ietf.callActivePeerId + ", address: " + root.out.ietf.callActivePeerAddress
                if root.out.ietf.callActivePeerSubAddress.length() > 0 {
                  root.out.object.label = root.out.object.label + ", sub-address: " + root.out.ietf.callActivePeerSubAddress
                }

                root.out.event.class.name = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallSetup"
                root.out.event.id = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallSetup"
                root.out.event.category.name = "call state"
                root.out.event.message = root.out.ietf.callActiveCallOrigin + " " + root.out.ietf.callActiveInfoType + " call setup"
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              if this.trap.VarBinds.length() > 6 {
                root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
                root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
                }
              if this.trap.VarBinds.length() > 7 {
                root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
                root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
                }
              if this.trap.VarBinds.length() > 8 {
                root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
                root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
                }
              if this.trap.VarBinds.length() > 9 {
                root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
                root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
                }
              }}}}}}}}}}

              root.out.event.class.name = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallSetup"
              root.out.event.id = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-dialCtlPeerCallSetup-unknown"
              root.out.event.category.name = "call state"
              root.out.event.message = "call setup - UNEXPECTED VARBINDS for dialCtlPeerCallSetup trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - processors:
    - label: default
      mapping: |
        #!blobl
        root = this

        if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
          root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
          root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
          }
        if this.trap.VarBinds.length() > 1 {
          root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
          root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
          }
        if this.trap.VarBinds.length() > 2 {
          root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
          root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
          }
        if this.trap.VarBinds.length() > 3 {
          root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
          root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
          }
        if this.trap.VarBinds.length() > 4 {
          root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
          root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
          }
        if this.trap.VarBinds.length() > 5 {
          root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
          root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
          }
        if this.trap.VarBinds.length() > 6 {
          root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
          root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
          }
        if this.trap.VarBinds.length() > 7 {
          root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
          root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
          }
        if this.trap.VarBinds.length() > 8 {
          root.out.snmptrap.varbind.oid_8 = this.trap.VarBinds.index(8).OID
          root.out.snmptrap.varbind.type_8 = this.trap.VarBinds.index(8).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(8).Type == 4 || this.trap.VarBinds.index(8).Type == 68 {
            root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_8 = this.trap.VarBinds.index(8).Value.string()
          }
        if this.trap.VarBinds.length() > 9 {
          root.out.snmptrap.varbind.oid_9 = this.trap.VarBinds.index(9).OID
          root.out.snmptrap.varbind.type_9 = this.trap.VarBinds.index(9).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(9).Type == 4 || this.trap.VarBinds.index(9).Type == 68 {
            root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_9 = this.trap.VarBinds.index(9).Value.string()
          }
        if this.trap.VarBinds.length() > 10 {
          root.out.snmptrap.varbind.oid_10 = this.trap.VarBinds.index(10).OID
          root.out.snmptrap.varbind.type_10 = this.trap.VarBinds.index(10).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(10).Type == 4 || this.trap.VarBinds.index(10).Type == 68 {
            root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_10 = this.trap.VarBinds.index(10).Value.string()
          }
        if this.trap.VarBinds.length() > 11 {
          root.out.snmptrap.varbind.oid_11 = this.trap.VarBinds.index(11).OID
          root.out.snmptrap.varbind.type_11 = this.trap.VarBinds.index(11).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(11).Type == 4 || this.trap.VarBinds.index(11).Type == 68 {
            root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_11 = this.trap.VarBinds.index(11).Value.string()
          }
        if this.trap.VarBinds.length() > 12 {
          root.out.snmptrap.varbind.oid_12 = this.trap.VarBinds.index(12).OID
          root.out.snmptrap.varbind.type_12 = this.trap.VarBinds.index(12).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(12).Type == 4 || this.trap.VarBinds.index(12).Type == 68 {
            root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_12 = this.trap.VarBinds.index(12).Value.string()
          }
        if this.trap.VarBinds.length() > 13 {
          root.out.snmptrap.varbind.oid_13 = this.trap.VarBinds.index(13).OID
          root.out.snmptrap.varbind.type_13 = this.trap.VarBinds.index(13).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(13).Type == 4 || this.trap.VarBinds.index(13).Type == 68 {
            root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_13 = this.trap.VarBinds.index(13).Value.string()
          }
        if this.trap.VarBinds.length() > 14 {
          root.out.snmptrap.varbind.oid_14 = this.trap.VarBinds.index(14).OID
          root.out.snmptrap.varbind.type_14 = this.trap.VarBinds.index(14).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(14).Type == 4 || this.trap.VarBinds.index(14).Type == 68 {
            root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_14 = this.trap.VarBinds.index(14).Value.string()
          }
        if this.trap.VarBinds.length() > 15 {
          root.out.snmptrap.varbind.oid_15 = this.trap.VarBinds.index(15).OID
          root.out.snmptrap.varbind.type_15 = this.trap.VarBinds.index(15).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(15).Type == 4 || this.trap.VarBinds.index(15).Type == 68 {
            root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_15 = this.trap.VarBinds.index(15).Value
          }
        }}}}}}}}}}}}}}}}

        root.out.event.class.name = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-unknown"
        root.out.event.id = "SNMPTRAP-DIAL-CONTROL-MIB-dialControlMibTrapPrefix-" + this.trap.SpecificTrap.string()
        root.out.event.category.name = "unknown specific trap"
        root.out.event.message = "unknown specific trap " + this.trap.SpecificTrap.string() + " from IETF DIAL-CONTROL-MIB-dialControlMibTrapPrefix"
        root.out.event.severity.code = 4
        root.out.event.severity.level = "Warning"
