- mapping: |-
    #!blobl
    root = this
    root.out.origin.agent.name = "Cisco CISCO-VTP-MIB"
- switch:
  - check: this.trap.SpecificTrap == 1
    # vtpConfigRevNumberError
    #
    # A configuration revision number error notification signifies that a device has incremented its
    # vtpConfigRevNumberErrors counter.
    #
    # managementDomainConfigRevNumber (Gauge32) - The current Configuration Revision Number as known by the local device
    #   for this management domain when managementDomainVersionInUse is version1(1) or version2(2). If
    #   managementDomainVersionInUse is version3(4), this object has the same value with vtpDatabaseRevisionNumber of
    #   VLAN database type. This value is updated (if necessary) whenever a VTP advertisement is received or generated.
    #   When in the 'no management-domain' state, this value is 0.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.4") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.managementDomainConfigRevNumber = this.trap.VarBinds.index(0).Value.string()

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.4")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigRevNumberError"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigRevNumberError"
                root.out.event.category.name = "VTP configuration state"
                root.out.event.message = "VTP configuration revision number error, rev. " + root.out.cisco.managementDomainConfigRevNumber
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigRevNumberError"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigRevNumberError-unknown"
              root.out.event.category.name = "VTP configuration state"
              root.out.event.message = "VTP configuration revision number error - UNEXPECTED VARBINDS for vtpConfigRevNumberError trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 2
    # vtpConfigDigestError
    #
    # A configuration digest error notification signifies that a device has incremented its vtpConfigDigestErrors
    # counter.
    #
    # managementDomainConfigRevNumber (Gauge32) - The current Configuration Revision Number as known by the local device
    #   for this management domain when managementDomainVersionInUse is version1(1) or version2(2). If
    #   managementDomainVersionInUse is version3(4), this object has the same value with vtpDatabaseRevisionNumber of
    #   VLAN database type. This value is updated (if necessary) whenever a VTP advertisement is received or generated.
    #   When in the 'no management-domain' state, this value is 0.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.4") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.managementDomainConfigRevNumber = this.trap.VarBinds.index(0).Value.string()

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.4")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigDigestError"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigDigestError"
                root.out.event.category.name = "VTP configuration state"
                root.out.event.message = "VTP configuration digest error, rev. " + root.out.cisco.managementDomainConfigRevNumber
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigDigestError"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpConfigDigestError-unknown"
              root.out.event.category.name = "VTP configuration state"
              root.out.event.message = "VTP configuration digest error - UNEXPECTED VARBINDS for vtpConfigDigestError trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 3
    # vtpServerDisabled
    #
    # A VTP Server disabled notification is generated when the local system is no longer able to function as a VTP
    # Server because the number of defined VLANs is greater than vtpMaxVlanStorage or the local system is not able to
    # recover complete VTP information after a reboot.
    #
    # managementDomainConfigRevNumber (Gauge32) - The current Configuration Revision Number as known by the local device
    #   for this management domain when managementDomainVersionInUse is version1(1) or version2(2). If
    #   managementDomainVersionInUse is version3(4), this object has the same value with vtpDatabaseRevisionNumber of
    #   VLAN database type. This value is updated (if necessary) whenever a VTP advertisement is received or generated.
    #   When in the 'no management-domain' state, this value is 0.
    # vtpMaxVlanStorage (Integer32) - An estimate of the maximum number of VLANs about which the local system can
    #   recover complete VTP information after a reboot.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 1 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.4") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.1.2") {
              meta varbinds_ok = true
          }}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.managementDomainConfigRevNumber = this.trap.VarBinds.index(0).Value.string()
                root.out.cisco.vtpMaxVlanStorage = this.trap.VarBinds.index(1).Value

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.4")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpServerDisabled"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpServerDisabled"
                root.out.event.category.name = "VTP server state"
                root.out.event.message = "VTP server disabled, defined VLANs exceeds maximum VLAN storage of " + root.out.cisco.vtpMaxVlanStorage.string()
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              }}}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpServerDisabled"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpServerDisabled-unknown"
              root.out.event.category.name = "VTP server state"
              root.out.event.message = "VTP server disabled - UNEXPECTED VARBINDS for vtpServerDisabled trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 4
    # vtpMtuTooBig
    #
    # A VTP MTU tooBig notification is generated when a VLAN's MTU size is larger than can be supported either:
    #  - by one or more of its trunk ports: the included vtpVlanState has the value 'mtuTooBigForTrunk' and the included
    #    vlanTrunkPortManagementDomain is for the first (or only) trunk port
    #  - by the device itself: vtpVlanState has the value 'mtuTooBigForDevice' and any instance of
    #    vlanTrunkPortManagementDomain is included.
    # Devices which have no trunk ports do not send vtpMtuTooBig notifications.
    #
    # vlanTrunkPortManagementDomain (Integer32) - The value of managementDomainIndex for the management domain on this
    #   trunk port.
    # vtpVlanState (INTEGER) - The state of this VLAN.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 1 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.6.1.1.2") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.3.1.1.2") {
              meta varbinds_ok = true
          }}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                meta vtpVlanState = this.trap.VarBinds.index(1).Value

                root.out.cisco.vlanTrunkPortManagementDomain = this.trap.VarBinds.index(0).Value.string()
                root.out.cisco.vtpVlanState = this.trap.VarBinds.index(1).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.9.9.46.1.3.1.1.2")

                root.out.object.name = "CISCO-VTP-MIB::vtpVlanEntry"
                root.out.object.index = this.trap.VarBinds.index(1).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.3.1.1.2")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.vtpVlanEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.cisco.managementDomainIndex = root.TEMP.vtpVlanEntry.index(0).string()
                root.out.cisco.vtpVlanIndex = root.TEMP.vtpVlanEntry.index(1).string()
                root.out.object.label = "domain: " + root.out.cisco.managementDomainIndex + ", VLAN: " + root.out.cisco.vtpVlanIndex

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpMtuTooBig"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpMtuTooBig"
                root.out.event.category.name = "VLAN state"

            - switch:
              - check: metadata("vtpVlanState") == 1
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-operational"
                      root.out.event.message = "VLAN operational, MTU size OK"
                      root.out.event.severity.code = 6
                      root.out.event.severity.level = "Informational"

              - check: metadata("vtpVlanState") == 2
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-suspended"
                      root.out.event.message = "VLAN suspended, MTU size too large"
                      root.out.event.severity.code = 3
                      root.out.event.severity.level = "Error"

              - check: metadata("vtpVlanState") == 3
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-mtuTooBigForDevice"
                      root.out.event.message = "VLAN MTU too big for device"
                      root.out.event.severity.code = 3
                      root.out.event.severity.level = "Error"

              - check: metadata("vtpVlanState") == 4
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-mtuTooBigForTrunk"
                      root.out.event.message = "VLAN MTU too big for trunk"
                      root.out.event.severity.code = 3
                      root.out.event.severity.level = "Error"

              - processors:
                - mapping: |-
                    #!blobl
                    root = this

                    root.out.event.id = root.out.event.id + "-unknown"
                    root.out.event.message = "VLAN state unknown, MTU size too large"
                    root.out.event.severity.code = 3
                    root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              }}}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpMtuTooBig"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpMtuTooBig-unknown"
              root.out.event.category.name = "VLAN state"
              root.out.event.message = "VLAN state changed - UNEXPECTED VARBINDS for vtpMtuTooBig trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 6
    # vtpVersionOneDeviceDetected
    #
    # A VTP version one device detected notification is generated by a device when:
    #   a) a management domain has been put into version 2 mode (as accessed by managementDomainVersionInUse).
    #   b) 15 minutes has passed since a).
    #   c) a version 1 PDU is detected on a trunk on the device that is in that management domain which has a lower
    #      revision number than the current configuration.
    #
    # vlanTrunkPortManagementDomain (Integer32) - The value of managementDomainIndex for the management domain on this
    #   trunk port.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.6.1.1.2") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.vlanTrunkPortManagementDomain = this.trap.VarBinds.index(0).Value.string()

                root.out.object.name = "IF-MIB::ifEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.6.1.1.2")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.cisco.vlanTrunkPortManagementDomain + ", trunk port: ifIndex " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionOneDeviceDetected"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionOneDeviceDetected"
                root.out.event.category.name = "trunk port VTP version"
                root.out.event.message = "VTP v1 device detected on non-v1 trunk port"
                root.out.event.severity.code = 4
                root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionOneDeviceDetected"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionOneDeviceDetected-unknown"
              root.out.event.category.name = "trunk port VTP version"
              root.out.event.message = "version one device detected on VTP trunk port - UNEXPECTED VARBINDS for vtpVersionOneDeviceDetected trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 7
    # vlanTrunkPortDynamicStatusChange
    #
    # A vlanTrunkPortDynamicStatusChange notification is generated by a device when the value of
    # vlanTrunkPortDynamicStatus object has been changed.
    #
    # vlanTrunkPortDynamicStatus (INTEGER) - Indicates whether the specified interface is either acting as a trunk or not.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.6.1.1.14") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                meta vlanTrunkPortDynamicStatus = this.trap.VarBinds.index(0).Value

                root.out.cisco.vlanTrunkPortDynamicStatus = this.trap.VarBinds.index(0).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.9.9.46.1.6.1.1.14")

                root.out.object.name = "IF-MIB::ifEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.6.1.1.14")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "trunk port: ifIndex " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vlanTrunkPortDynamicStatusChange"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vlanTrunkPortDynamicStatusChange"
                root.out.event.category.name = "trunk port dynamic trunking state"

            - switch:
              - check: metadata("vlanTrunkPortDynamicStatus") == 1
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-on"
                      root.out.event.message = "trunk port dynamic trunking on, always a trunk and will initiate negotiation"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - check: metadata("vlanTrunkPortDynamicStatus") == 2
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-off"
                      root.out.event.message = "trunk port dynamic trunking off, never a trunk"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - check: metadata("vlanTrunkPortDynamicStatus") == 3
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-desirable"
                      root.out.event.message = "trunk port dynamic trunking desirable, will initiate negotiation"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - check: metadata("vlanTrunkPortDynamicStatus") == 4
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-auto"
                      root.out.event.message = "trunk port dynamic trunking automatic, capable and willing but doesn't initiate negotiation"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - check: metadata("vlanTrunkPortDynamicStatus") == 5
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-onNoNegotiate"
                      root.out.event.message = "trunk port dynamic trunking on, always a trunk but doesn't initiate negotiation"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - processors:
                - mapping: |-
                    #!blobl
                    root = this

                    root.out.event.id = root.out.event.id + "-unknown"
                    root.out.event.message = "trunk port dynamic trunking state unknown"
                    root.out.event.severity.code = 4
                    root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vlanTrunkPortDynamicStatusChange"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vlanTrunkPortDynamicStatusChange-unknown"
              root.out.event.category.name = "trunk port dynamic trunking state"
              root.out.event.message = "trunk port dynamic trunking state changed - UNEXPECTED VARBINDS for vlanTrunkPortDynamicStatusChange trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 8
    # vtpLocalModeChanged
    #
    # A vtpLocalModeChanged notification is generated by a device when the value of the object managementDomainLocalMode
    # is changed.
    #
    # managementDomainLocalMode (INTEGER) - The local VTP mode in this management domain.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.3") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.managementDomainLocalMode = this.trap.VarBinds.index(0).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.9.9.46.1.2.1.1.3")

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.3")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpLocalModeChanged"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpLocalModeChanged"
                root.out.event.category.name = "VTP local mode state"
                root.out.event.message = "VTP local mode changed to " + root.out.cisco.managementDomainLocalMode
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpLocalModeChanged"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpLocalModeChanged-unknown"
              root.out.event.category.name = "VTP local mode state"
              root.out.event.message = "VTP local mode state change - UNEXPECTED VARBINDS for vtpLocalModeChanged trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 9
    # vtpVersionInUseChanged
    #
    # A vtpVersionInUseChanged notification is generated by a device when the value of the object
    # managementDomainVersionInUse is changed.
    #
    # managementDomainVersionInUse (INTEGER) - The current version of the VTP that is in use by the designated
    #   management domain.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.11") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.managementDomainVersionInUse = this.trap.VarBinds.index(0).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.9.9.46.1.2.1.1.11")

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.11")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionInUseChanged"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionInUseChanged"
                root.out.event.category.name = "VTP in-use version"
                root.out.event.message = "VTP version in-use changed to " + root.out.cisco.managementDomainVersionInUse
                root.out.event.severity.code = 4
                root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionInUseChanged"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVersionInUseChanged-unknown"
              root.out.event.category.name = "VTP in-use version"
              root.out.event.message = "VTP version in-use changed - UNEXPECTED VARBINDS for vtpVersionInUseChanged trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 10
    # vtpVlanCreated
    #
    # A vtpVlanCreated notification is generated by a device when a VLAN is created.
    #
    # vtpVlanName (DisplayString) - The name of this VLAN.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.3.1.1.4") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.vtpVlanName = this.trap.VarBinds.index(0).Value.snmp_octet_display_hint("255t")

                root.out.object.name = "CISCO-VTP-MIB::vtpVlanEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.3.1.1.4")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.vtpVlanEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.cisco.managementDomainIndex = root.TEMP.vtpVlanEntry.index(0).string()
                root.out.cisco.vtpVlanIndex = root.TEMP.vtpVlanEntry.index(1).string()
                root.out.object.label = "domain: " + root.out.cisco.managementDomainIndex + ", VLAN: " + root.out.cisco.vtpVlanIndex + ", VLAN name: " + root.out.cisco.vtpVlanName

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanCreated"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanCreated"
                root.out.event.category.name = "VLAN state"
                root.out.event.message = "VLAN created"
                root.out.event.severity.code = 5
                root.out.event.severity.level = "Notice"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanCreated"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanCreated-unknown"
              root.out.event.category.name = "VLAN state"
              root.out.event.message = "VLAN created - UNEXPECTED VARBINDS for vtpVlanCreated trap!"
              root.out.event.severity.code = 5
              root.out.event.severity.level = "Notice"

  - check: this.trap.SpecificTrap == 11
    # vtpVlanDeleted
    #
    # A vtpVlanDeleted notification is generated by a device when a VLAN is deleted.
    #
    # vtpVlanName (DisplayString) - The name of this VLAN.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.3.1.1.4") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.vtpVlanName = this.trap.VarBinds.index(0).Value.snmp_octet_display_hint("255t")

                root.out.object.name = "CISCO-VTP-MIB::vtpVlanEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.3.1.1.4")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.vtpVlanEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.cisco.managementDomainIndex = root.TEMP.vtpVlanEntry.index(0).string()
                root.out.cisco.vtpVlanIndex = root.TEMP.vtpVlanEntry.index(1).string()
                root.out.object.label = "domain: " + root.out.cisco.managementDomainIndex + ", VLAN: " + root.out.cisco.vtpVlanIndex + ", VLAN name: " + root.out.cisco.vtpVlanName

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanDeleted"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanDeleted"
                root.out.event.category.name = "VLAN state"
                root.out.event.message = "VLAN deleted"
                root.out.event.severity.code = 4
                root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanDeleted"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanDeleted-unknown"
              root.out.event.category.name = "VLAN state"
              root.out.event.message = "VLAN deleted - UNEXPECTED VARBINDS for vtpVlanDeleted trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - check: this.trap.SpecificTrap == 12
    # vtpVlanRingNumberConflict
    #
    # A VTP ring number configuration conflict notification is generated if, and only at the time when, a device learns
    # of a conflict between:
    #   a) the ring number (vtpVlanPortLocalSegment) being used on a token ring segment attached to the port identified
    #      by ifIndex, and
    #   b) the VTP-obtained ring number (vtpVlanRingNumber) for the VLAN identified by vtpVlanIndex.
    # When such a conflict occurs, the bridge port is put into an administrative down position until the conflict is
    # resolved through local/network management intervention. This notification is only applicable to VLANs of type
    # 'tokenRing'.
    #
    # vtpVlanRingNumber (Integer32) - The ring number of this VLAN.
    # ifIndex (Integer32) - A unique value, greater than zero, for each interface.
    # vtpVlanPortLocalSegment (Integer32) - The ring (segment) number in use on a 802.5 ring.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 2 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.3.1.1.7") {
            if this.trap.VarBinds.index(1).OID.has_prefix(".1.3.6.1.2.1.2.2.1.1") {
            if this.trap.VarBinds.index(2).OID.has_prefix(".1.3.6.1.4.1.9.9.46.2.1.1") {
              meta varbinds_ok = true
          }}}}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                root.out.cisco.vtpVlanRingNumber = this.trap.VarBinds.index(0).Value.string()
                root.out.ietf.ifIndex = this.trap.VarBinds.index(1).Value.string()
                root.out.cisco.vtpVlanPortLocalSegment = this.trap.VarBinds.index(2).Value.string()

                root.out.object.name = "CISCO-VTP-MIB::vtpVlanEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.3.1.1.7")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.TEMP.vtpVlanEntry = root.out.object.index.snmp_oid_extract_index("Integer,Integer")
                root.out.cisco.managementDomainIndex = root.TEMP.vtpVlanEntry.index(0).string()
                root.out.cisco.vtpVlanIndex = root.TEMP.vtpVlanEntry.index(1).string()
                root.out.object.label = "domain: " + root.out.cisco.managementDomainIndex + ", VLAN: " + root.out.cisco.vtpVlanIndex + ", ring: " + root.out.cisco.vtpVlanRingNumber + ", interface: ifIndex " + root.out.ietf.ifIndex + ", segment: " + root.out.cisco.vtpVlanPortLocalSegment

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanRingNumberConflict"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanRingNumberConflict"
                root.out.event.category.name = "VTP VLAN ring number state"
                root.out.event.message = "VTP VLAN ring number conflict"
                root.out.event.severity.code = 3
                root.out.event.severity.level = "Error"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              if this.trap.VarBinds.length() > 4 {
                root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
                root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
                }
              if this.trap.VarBinds.length() > 5 {
                root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
                root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
                }
              }}}}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanRingNumberConflict"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpVlanRingNumberConflict-unknown"
              root.out.event.category.name = "VTP VLAN ring number state"
              root.out.event.message = "VTP VLAN ring number conflict - UNEXPECTED VARBINDS for vtpVlanRingNumberConflict trap!"
              root.out.event.severity.code = 3
              root.out.event.severity.level = "Error"

  - check: this.trap.SpecificTrap == 13
    # vtpPruningStateOperChange
    #
    # A vtpPruningStateOperChange notification is generated by the device when the instance value of
    # managementDomainPruningStateOper is changed.
    #
    # managementDomainPruningStateOper (INTEGER) - Indicates whether VTP pruning is operationally enabled or disabled in
    #   this managament domain.
    processors:
      - mapping: |-
          #!blobl
          root = this

          meta varbinds_ok = false
          if this.trap.VarBinds.length() > 0 {
            if this.trap.VarBinds.index(0).OID.has_prefix(".1.3.6.1.4.1.9.9.46.1.2.1.1.12") {
              meta varbinds_ok = true
          }}

      - switch:
        - check: metadata("varbinds_ok")
          processors:
            - mapping: |-
                #!blobl
                root = this

                meta managementDomainPruningStateOper = this.trap.VarBinds.index(0).Value

                root.out.cisco.managementDomainPruningStateOper = this.trap.VarBinds.index(0).Value.snmp_int_enum_enrich(".1.3.6.1.4.1.9.9.46.1.2.1.1.12")

                root.out.object.name = "CISCO-VTP-MIB::managementDomainEntry"
                root.out.object.index = this.trap.VarBinds.index(0).OID.snmp_oid_get_index(".1.3.6.1.4.1.9.9.46.1.2.1.1.12")
                root.out.object.entity = this.trap.AgentAddress.string() + "_" + root.out.object.name + "." + root.out.object.index
                root.out.object.label = "domain: " + root.out.object.index

                root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpPruningStateOperChange"
                root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpPruningStateOperChange"
                root.out.event.category.name = "VTP pruning state"

            - switch:
              - check: metadata("managementDomainPruningStateOper") == 1
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-enabled"
                      root.out.event.message = "VTP pruning enabled"
                      root.out.event.severity.code = 5
                      root.out.event.severity.level = "Notice"

              - check: metadata("managementDomainPruningStateOper") == 2
                processors:
                  - mapping: |-
                      #!blobl
                      root = this

                      root.out.event.id = root.out.event.id + "-disabled"
                      root.out.event.message = "VTP pruning disabled"
                      root.out.event.severity.code = 4
                      root.out.event.severity.level = "Warning"

              - processors:
                - mapping: |-
                    #!blobl
                    root = this

                    root.out.event.id = root.out.event.id + "-unknown"
                    root.out.event.message = "VTP pruning state unknown"
                    root.out.event.severity.code = 4
                    root.out.event.severity.level = "Warning"

            - mapping: |-
                #!blobl
                root = this

                root.out.event.message = if root.out.exists("object.label") {
                  root.out.event.message + "  [ " + root.out.object.label + " ]"
                }

        - processors:
          - mapping: |-
              #!blobl
              root = this

              if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
                root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
                root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
                }
              if this.trap.VarBinds.length() > 1 {
                root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
                root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
                }
              if this.trap.VarBinds.length() > 2 {
                root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
                root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
                }
              if this.trap.VarBinds.length() > 3 {
                root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
                root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
                if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
                } else {
                  root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
                }
              }}}}

              root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpPruningStateOperChange"
              root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-vtpPruningStateOperChange-unknown"
              root.out.event.category.name = "VTP pruning state"
              root.out.event.message = "VTP pruning state changed - UNEXPECTED VARBINDS for vtpPruningStateOperChange trap!"
              root.out.event.severity.code = 4
              root.out.event.severity.level = "Warning"

  - processors:
    - label: default
      mapping: |
        #!blobl
        root = this

        if this.trap.exists("VarBinds") && this.trap.VarBinds.length() > 0 {
          root.out.snmptrap.varbind.oid_0 = this.trap.VarBinds.index(0).OID
          root.out.snmptrap.varbind.type_0 = this.trap.VarBinds.index(0).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(0).Type == 4 || this.trap.VarBinds.index(0).Type == 68 {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_0 = this.trap.VarBinds.index(0).Value.string()
          }
        if this.trap.VarBinds.length() > 1 {
          root.out.snmptrap.varbind.oid_1 = this.trap.VarBinds.index(1).OID
          root.out.snmptrap.varbind.type_1 = this.trap.VarBinds.index(1).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(1).Type == 4 || this.trap.VarBinds.index(1).Type == 68 {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_1 = this.trap.VarBinds.index(1).Value.string()
          }
        if this.trap.VarBinds.length() > 2 {
          root.out.snmptrap.varbind.oid_2 = this.trap.VarBinds.index(2).OID
          root.out.snmptrap.varbind.type_2 = this.trap.VarBinds.index(2).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(2).Type == 4 || this.trap.VarBinds.index(2).Type == 68 {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_2 = this.trap.VarBinds.index(2).Value.string()
          }
        if this.trap.VarBinds.length() > 3 {
          root.out.snmptrap.varbind.oid_3 = this.trap.VarBinds.index(3).OID
          root.out.snmptrap.varbind.type_3 = this.trap.VarBinds.index(3).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(3).Type == 4 || this.trap.VarBinds.index(3).Type == 68 {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_3 = this.trap.VarBinds.index(3).Value.string()
          }
        if this.trap.VarBinds.length() > 4 {
          root.out.snmptrap.varbind.oid_4 = this.trap.VarBinds.index(4).OID
          root.out.snmptrap.varbind.type_4 = this.trap.VarBinds.index(4).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(4).Type == 4 || this.trap.VarBinds.index(4).Type == 68 {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_4 = this.trap.VarBinds.index(4).Value.string()
          }
        if this.trap.VarBinds.length() > 5 {
          root.out.snmptrap.varbind.oid_5 = this.trap.VarBinds.index(5).OID
          root.out.snmptrap.varbind.type_5 = this.trap.VarBinds.index(5).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(5).Type == 4 || this.trap.VarBinds.index(5).Type == 68 {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_5 = this.trap.VarBinds.index(5).Value.string()
          }
        if this.trap.VarBinds.length() > 6 {
          root.out.snmptrap.varbind.oid_6 = this.trap.VarBinds.index(6).OID
          root.out.snmptrap.varbind.type_6 = this.trap.VarBinds.index(6).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(6).Type == 4 || this.trap.VarBinds.index(6).Type == 68 {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_6 = this.trap.VarBinds.index(6).Value.string()
          }
        if this.trap.VarBinds.length() > 7 {
          root.out.snmptrap.varbind.oid_7 = this.trap.VarBinds.index(7).OID
          root.out.snmptrap.varbind.type_7 = this.trap.VarBinds.index(7).Type.snmp_int_enum_enrich(".1_SnmpTypes")
          if this.trap.VarBinds.index(7).Type == 4 || this.trap.VarBinds.index(7).Type == 68 {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.snmp_octet_string()
          } else {
            root.out.snmptrap.varbind.value_7 = this.trap.VarBinds.index(7).Value.string()
          }
        }}}}}}}}

        root.out.event.class.name = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-unknown"
        root.out.event.id = "SNMPTRAP-CISCO-VTP-MIB-vtpNotifications-" + this.trap.SpecificTrap.string()
        root.out.event.category.name = "unknown specific trap"
        root.out.event.message = "unknown specific trap " + this.trap.SpecificTrap.string() + " from Cisco CISCO-VTP-MIB-vtpNotifications"
        root.out.event.severity.code = 4
        root.out.event.severity.level = "Warning"
